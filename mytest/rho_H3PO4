DATABASE ../database/phreeqc.dat
SELECTED_OUTPUT 101
    -file                 rho_H3PO4_101.sel
USER_PUNCH 101
    -headings Mu SC
    -start
10 PUNCH STR_F$(MU, 20, 12)
20 PUNCH STR_F$(SC, 20, 10)
    -end
#PRINT; -reset false
SOLUTION_SPECIES
PO4-3 = PO4-3
	-gamma	4.0	0
	-dw	0.612e-9
	-Vm  -.5259  -9.0654  9.3131  -2.4042  5.6114 # supcrt
PO4-3 + H+ = HPO4-2
	-log_k	12.346
	-delta_h -3.530	kcal
	-gamma	5.0	0
	-dw	0.69e-9
	-Vm  3.6315  1.0857  5.3233  -2.8239  3.3363 # supcrt
PO4-3 + 2 H+ = H2PO4- # minteq.v4.dat, NIST46.3
	-log_k	19.573
	-delta_h	-18	kJ
	-gamma	5.4	0
	-dw	 0.846e-9
	-Vm  6.4875  8.0594  2.5823  -3.1122  1.3003 # supcrt
PO4-3 + 3H+ = H3PO4 # minteq.v4.dat, NIST46.3
	log_k	21.721
	delta_h	-10.1	kJ
	-Vm  8.2727     12.4182      0.8691     -3.2924  -0.22 # supcrt

# P < 4.2

SOLUTION_SPECIES
PO4-3 = PO4-3
	-gamma	4.0	0
	-dw	0.612e-9
	-Vm  -.5259  -9.0654  9.3131  -2.4042  5.6114 # supcrt
	-Vm   1.2391163E+00 -9.0700000E+00   9.3100000E+00  -2.4000000E+00   5.6100000E+00  0.0000000E+00   0.0000000E+00   0.0000000E+00  -1.4148347E-02    1.0000000E+00
	-Vm   1.24  -9.07  9.31  -2.4  5.61  0  0  0  -1.41e-2  1 # ref. 2
PO4-3 + H+ = HPO4-2
	-log_k	12.346
	-delta_h -3.530	kcal
	-gamma	5.0	0
	# -log_k	12.375 # log_k and delta_h from minteq.v4.dat, NIST46.3
	# -delta_h -15	kJ
	# -gamma	5.0	0
	-dw	0.69e-9
	-Vm  3.6315  1.0857  5.3233  -2.8239  3.3363 # supcrt
	-Vm    3.5184654E+00   1.0900000E+00    8.3884226E-01   -2.8200000E+00    3.3400000E+00   0.0000000E+00    0.0000000E+00    0.0000000E+00    0.0000000E+00    1.0000000E+00
	-Vm   3.52  1.09  8.39  -2.82  3.34  0  0  0  0  1 # ref. 2
PO4-3 + 2 H+ = H2PO4-
	-log_k	19.553
	-delta_h -4.520	kcal
	-gamma	5.4	0
	# -log_k	19.573 # log_k and delta_h from minteq.v4.dat, NIST46.3
	# -delta_h	-18	kJ
	# -gamma	5.4	0
	-dw	 0.846e-9
	-Vm  6.4875  8.0594  2.5823  -3.1122  1.3003 # supcrt
	-Vm    5.5819275E+00   8.0600000E+00    1.2243286E+01   -3.1100000E+00    1.3000000E+00   0.0000000E+00    0.0000000E+00    0.0000000E+00    1.6193384E-02    1.0000000E+00
	-Vm   5.58  8.06  12.2  -3.11  1.3  0  0  0  1.62e-2  1 # ref. 2
PO4-3 + 3H+ = H3PO4 # minteq.v4.dat, NIST46.3
	log_k	21.721
	delta_h	-10.1	kJ
	-Vm  8.2727     12.4182      0.8691     -3.2924  -0.22 # supcrt
	-Vm    7.4700000E+00   1.2400000E+01    6.2900000E+00   -3.2900000E+00    0.0000000E+00 #  0.0000000E+00    0.0000000E+00    0.0000000E+00    0.0000000E+00    0.0000000E+00
	-Vm   7.47  12.4  6.29  -3.29  0
Na+ + HPO4-2 = NaHPO4-
	-log_k	0.29
	-gamma	5.4	0
# Na+ + H+ + PO4-3 = NaHPO4-
	# -log_k	13.445 # log_k from minteq.v4.dat, NIST46.3
	# -gamma	5.4	0 #     0.0000000E+00
	-Vm    5.2000000E+00   8.1000000E+00    1.3000000E+01   -3.0000000E+00    9.0000000E-01   0.0000000E+00    0.0000000E+00    0.0000000E+00    1.6193384E-02    1.0000000E+00
	-Vm    5.2  8.1  13  -3  0.9  0  0  1.62e-2  1 # ref. 2
K+ + HPO4-2 = KHPO4-
	-log_k	0.29
	-gamma	5.4	0
# K+ + H+ + PO4-3 = KHPO4-
	# -log_k	13.255 # log_k from minteq.v4.dat, NIST46.3
	# -gamma	5.4	0 #     0.0000000E+00
	-Vm    5.4000000E+00   8.1000000E+00    1.9000000E+01   -3.1000000E+00    7.0000000E-01   0.0000000E+00    0.0000000E+00    0.0000000E+00    1.6193384E-02    1.0000000E+00
	-Vm   5.4  8.1  19  -3.1  0.7  0  0  0  1.62e-2  1 # ref. 2



SOLUTION 1; pH 7 charge
END
END

USE solution 1
REACTION_TEMPERATURE; 15.900000
REACTION_PRESSURE; 1.000000
# from 0 to 5.
REACTION; H3PO4 1
0 0.466800 1.031500 2.377900 4.150500 6.434100 
USER_GRAPH; -headings 16.ºC, 1.atm density
 -axis_titles "H3PO4 / (mol/kg H2O)" "(measured - calculated) density / (g/L)" "density / (g/L)"
10 data 0, 1023.200000, 1051.400000, 1111.400000, 1179.100000, 1251.100000, 
20 dim d(6)
30 read d(1), d(2), d(3), d(4), d(5), d(6), 
40 if step_no = 1 then put(rho, 10)
#50 if step_no > 1 then Vmol = (1e3 + tot("P") * 97.9978) / (tot("P") * rho) - 1e3 / (tot("P") * get(10))
50 if step_no > 1 then Vmol = 1 * Vm("H+") + 1 * Vm("H2PO4-")
60 if step_no = 1 then dif = 0 else dif = rho * 1e3 - d(step_no)
# 62 if tot("P") > 4.2 then dif = 0 
# 64 if tc <> 25 then end # dif = 0 
90 if step_no = 6 then put(step_no + get(1), 1)
100 if step_no = 1 then end
110 plot_xy tot("P"), 1e3 * rho -  d(step_no), symbol = Square, line_w = 0, color = Red
120 plot_xy tot("P"), 1e3 * rho, symbol = None, color = Red, y_axis = 2 
150 end
END
KNOBS
-iter 1000
USE solution 1
REACTION_TEMPERATURE; 25.000000
REACTION_PRESSURE; 1.000000
# from 5 to 143.
REACTION; H3PO4 1
0 0.010000 0.020000 0.030100 0.040200 0.049100 0.050000 0.050300 0.060400 0.060700 0.070500 0.080600 0.090800 0.094100 0.099600 0.101000 0.105500 0.111200 0.121500 0.127200 0.131700 0.142000 \ 
0.152300 0.162600 0.172900 0.183300 0.193700 0.204100 0.214500 0.225000 0.235400 0.245900 0.256400 0.267000 0.268600 0.277500 0.288100 0.298700 0.300100 0.309300 0.319900 0.320600 0.330600 \ 
0.341300 0.352000 0.362700 0.373500 0.384200 0.395000 0.405800 0.416700 0.427500 0.438400 0.438700 0.449300 0.460300 0.466800 0.471200 0.482200 0.493200 0.500000 0.504200 0.515300 0.526300 \ 
0.537400 0.545000 0.548500 0.559700 0.570900 0.582000 0.593200 0.604500 0.615700 0.627000 0.638300 0.699200 0.752700 0.778200 0.808200 0.869600 0.989100 1.000600 1.014200 1.021400 1.031500 \ 
1.111200 1.210700 1.236000 1.363700 1.494300 1.628000 1.764800 1.904800 2.048300 2.195200 2.345800 2.377900 2.500100 2.658400 2.820600 2.987200 3.158000 3.333500 3.513700 3.698800 3.889100 \ 
4.084700 4.150500 4.285900 4.493000 4.706100 4.925600 5.151800 5.384900 5.625300 5.873300 6.129300 6.393700 6.434100 6.667000 6.949500 7.241700 7.544200 7.857500 8.182200 8.518900 8.868300 \ 
9.231200 9.608300 10.000500 10.408600 10.833800 11.277100 11.739700 12.222800 12.727900 13.256400 13.810200 14.390900 
USER_GRAPH; -headings 25.ºC, 1.atm density
# -axis_titles "H3PO4 / (mol/kg H2O)" "(measured - calculated) density / (g/L)"
10 data 0, 997.600000, 998.100000, 998.700000, 999.300000, 999.730000, 999.770000, 999.800000, 1000.400000, 1000.360000, 1000.900000, 1001.500000, 1002.000000, 1002.140000, 1002.430000, 1002.600000, 1002.900000, 1003.100000, 1003.700000, 1004.080000, 1004.200000, 1004.700000, \ 
1005.300000, 1005.800000, 1006.400000, 1006.900000, 1007.500000, 1008.000000, 1008.500000, 1009.100000, 1009.600000, 1010.100000, 1010.700000, 1011.200000, 1011.100000, 1011.800000, 1012.300000, 1012.900000, 1012.690000, 1013.400000, 1014.000000, 1014.270000, 1014.500000, \ 
1015.100000, 1015.600000, 1016.200000, 1016.700000, 1017.300000, 1017.800000, 1018.300000, 1018.900000, 1019.500000, 1020.000000, 1019.630000, 1020.600000, 1021.100000, 1021.300000, 1021.700000, 1022.200000, 1022.800000, 1022.660000, 1023.300000, 1023.900000, 1024.400000, \ 
1025.000000, 1025.760000, 1025.500000, 1026.100000, 1026.600000, 1027.200000, 1027.800000, 1028.300000, 1028.900000, 1029.400000, 1030.000000, 1032.370000, 1035.600000, 1037.410000, 1037.520000, 1041.200000, 1046.900000, 1046.540000, 1047.180000, 1049.260000, 1048.900000, \ 
1052.700000, 1056.220000, 1058.400000, 1064.300000, 1070.200000, 1076.200000, 1082.200000, 1088.300000, 1094.400000, 1100.500000, 1106.800000, 1107.200000, 1113.100000, 1119.500000, 1125.900000, 1132.400000, 1138.900000, 1145.500000, 1152.200000, 1158.900000, 1165.700000, \ 
1172.600000, 1174.200000, 1179.500000, 1186.500000, 1193.600000, 1200.700000, 1207.900000, 1215.100000, 1222.500000, 1229.900000, 1237.400000, 1244.900000, 1246.100000, 1252.600000, 1260.300000, 1268.100000, 1275.900000, 1283.900000, 1291.900000, 1300.100000, 1308.300000, \ 
1316.500000, 1324.900000, 1333.300000, 1341.800000, 1350.400000, 1359.100000, 1367.800000, 1376.700000, 1385.600000, 1394.600000, 1403.700000, 1412.900000, 
20 dim d(139)
30 read d(1), d(2), d(3), d(4), d(5), d(6), d(7), d(8), d(9), d(10), d(11), d(12), d(13), d(14), d(15), d(16), d(17), d(18), d(19), d(20), d(21), \ 
d(22), d(23), d(24), d(25), d(26), d(27), d(28), d(29), d(30), d(31), d(32), d(33), d(34), d(35), d(36), d(37), d(38), d(39), d(40), d(41), d(42), \ 
d(43), d(44), d(45), d(46), d(47), d(48), d(49), d(50), d(51), d(52), d(53), d(54), d(55), d(56), d(57), d(58), d(59), d(60), d(61), d(62), d(63), \ 
d(64), d(65), d(66), d(67), d(68), d(69), d(70), d(71), d(72), d(73), d(74), d(75), d(76), d(77), d(78), d(79), d(80), d(81), d(82), d(83), d(84), \ 
d(85), d(86), d(87), d(88), d(89), d(90), d(91), d(92), d(93), d(94), d(95), d(96), d(97), d(98), d(99), d(100), d(101), d(102), d(103), d(104), d(105), \ 
d(106), d(107), d(108), d(109), d(110), d(111), d(112), d(113), d(114), d(115), d(116), d(117), d(118), d(119), d(120), d(121), d(122), d(123), d(124), d(125), d(126), \ 
d(127), d(128), d(129), d(130), d(131), d(132), d(133), d(134), d(135), d(136), d(137), d(138), d(139), 
40 if step_no = 1 then put(rho, 10)
#50 if step_no > 1 then Vmol = (1e3 + tot("P") * 97.9978) / (tot("P") * rho) - 1e3 / (tot("P") * get(10))
50 if step_no > 1 then Vmol = 1 * Vm("H+") + 1 * Vm("H2PO4-")
60 if step_no = 1 then dif = 0 else dif = rho * 1e3 - d(step_no)
# 62 if tot("P") > 4.2 then dif = 0 
# 64 if tc <> 25 then end # dif = 0 
90 if step_no = 139 then put(step_no + get(1), 1)
100 if step_no = 1 then end
110 plot_xy tot("P"), 1e3 * rho -  d(step_no), symbol = Diamond, line_w = 0, color = Green
120 plot_xy tot("P"), 1e3 * rho, symbol = None, color = Green, y_axis = 2 
150 end
END

USE solution 1
REACTION_TEMPERATURE; 40.800000
REACTION_PRESSURE; 1.000000
# from 143 to 150.
REACTION; H3PO4 1
0 0.466800 1.031500 2.377900 4.150500 6.434100 9.747700 14.716400 
USER_GRAPH; -headings 41.ºC, 1.atm density
# -axis_titles "H3PO4 / (mol/kg H2O)" "(measured - calculated) density / (g/L)"
10 data 0, 1015.900000, 1042.800000, 1100.900000, 1166.700000, 1237.100000, 1318.300000, 1407.600000, 
20 dim d(8)
30 read d(1), d(2), d(3), d(4), d(5), d(6), d(7), d(8), 
40 if step_no = 1 then put(rho, 10)
#50 if step_no > 1 then Vmol = (1e3 + tot("P") * 97.9978) / (tot("P") * rho) - 1e3 / (tot("P") * get(10))
50 if step_no > 1 then Vmol = 1 * Vm("H+") + 1 * Vm("H2PO4-")
60 if step_no = 1 then dif = 0 else dif = rho * 1e3 - d(step_no)
# 62 if tot("P") > 4.2 then dif = 0 
# 64 if tc <> 25 then end # dif = 0 
90 if step_no = 8 then put(step_no + get(1), 1)
100 if step_no = 1 then end
110 plot_xy tot("P"), 1e3 * rho -  d(step_no), symbol = Triangle, line_w = 0, color = Blue
120 plot_xy tot("P"), 1e3 * rho, symbol = None , color = Blue, y_axis = 2 
150 end
END

USE solution 1
REACTION_TEMPERATURE; 60.800000
REACTION_PRESSURE; 1.000000
# from 150 to 157.
REACTION; H3PO4 1
0 0.466800 1.031500 2.377900 4.150500 6.434100 9.747700 14.716400 
USER_GRAPH; -headings 61.ºC, 1.atm density
# -axis_titles "H3PO4 / (mol/kg H2O)" "(measured - calculated) density / (g/L)"
10 data 0, 1006.400000, 1032.900000, 1091.000000, 1156.100000, 1225.600000, 1305.400000, 1393.800000, 
20 dim d(8)
30 read d(1), d(2), d(3), d(4), d(5), d(6), d(7), d(8), 
40 if step_no = 1 then put(rho, 10)
#50 if step_no > 1 then Vmol = (1e3 + tot("P") * 97.9978) / (tot("P") * rho) - 1e3 / (tot("P") * get(10))
50 if step_no > 1 then Vmol = 1 * Vm("H+") + 1 * Vm("H2PO4-")
60 if step_no = 1 then dif = 0 else dif = rho * 1e3 - d(step_no)
# 62 if tot("P") > 4.2 then dif = 0 
# 64 if tc <> 25 then end # dif = 0 
90 if step_no = 8 then put(step_no + get(1), 1)
100 if step_no = 1 then end
110 plot_xy tot("P"), 1e3 * rho -  d(step_no), symbol = Circle, line_w = 0, color = Orange
120 plot_xy tot("P"), 1e3 * rho, symbol = None , color = Orange, y_axis = 2 
150 end
END

USE solution 1
REACTION_TEMPERATURE; 81.400000
REACTION_PRESSURE; 1.000000
# from 157 to 164.
REACTION; H3PO4 1
0 0.466800 1.031500 2.377900 4.150500 6.434100 9.747700 14.716400 
USER_GRAPH; -headings 81.ºC, 1.atm density
# -axis_titles "H3PO4 / (mol/kg H2O)" "(measured - calculated) density / (g/L)"
10 data 0, 994.500000, 1021.000000, 1077.600000, 1141.500000, 1211.600000, 1291.100000, 1378.800000, 
20 dim d(8)
30 read d(1), d(2), d(3), d(4), d(5), d(6), d(7), d(8), 
40 if step_no = 1 then put(rho, 10)
#50 if step_no > 1 then Vmol = (1e3 + tot("P") * 97.9978) / (tot("P") * rho) - 1e3 / (tot("P") * get(10))
50 if step_no > 1 then Vmol = 1 * Vm("H+") + 1 * Vm("H2PO4-")
60 if step_no = 1 then dif = 0 else dif = rho * 1e3 - d(step_no)
# 62 if tot("P") > 4.2 then dif = 0 
# 64 if tc <> 25 then end # dif = 0 
90 if step_no = 8 then put(step_no + get(1), 1)
100 if step_no = 1 then end
110 plot_xy tot("P"), 1e3 * rho -  d(step_no), symbol = XCross, line_w = 0, color = Magenta
120 plot_xy tot("P"), 1e3 * rho , symbol = None , color = Magenta, y_axis = 2 
150 end
END
# tot_calcs = 169
