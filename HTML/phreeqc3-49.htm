<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"><HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 7.0/HTML Export Filter">
<LINK REL="STYLESHEET" HREF="phreeqc3.css" CHARSET="ISO-8859-1" TYPE="text/css">
<TITLE> TRANSPORT</TITLE><HR><P> | <A HREF="phreeqc3-50.htm">Next</A> || <A HREF="phreeqc3-48.htm">Previous</A> || <A HREF="phreeqc3.htm">Top</A>  | </P></HEAD>
<BODY BGCOLOR="#ffffff">
<H2 CLASS="FM3d-order-node">
<A NAME="50622465_pgfId-546762"></A><STRONG CLASS="Bold">
TRANSPORT</STRONG>
<A NAME="50622465_87317"></A></H2>
<P CLASS="BodyText">
<A NAME="50622465_pgfId-719643"></A>This keyword data block is used to simulate one-dimensional (1D) transport of solutes, water, colloids, and heat due to the processes of advection and dispersion, diffusion, and diffusion into stagnant zones adjacent to the 1D flow system. Radial and three-dimensional (3D) diffusion can be modeled by using stagnant zones. Multicomponent diffusion allows individual tracer diffusion coefficients to be used in calculating the diffusion of ions; <STRONG CLASS="Bold">
TRANSPORT</STRONG>
 has capabilities to model multicomponent diffusion in the aqueous solution and in the interlayers of swelling clay minerals. All the chemical processes modeled by PHREEQC, including kinetically controlled reactions, may be included in an advective-dispersive transport simulation. Purely advective transport plus reactions--without diffusion, dispersion, or stagnant zones--can be simulated with the <STRONG CLASS="Bold">
<A HREF="phreeqc3-6.htm#50622465_87438" CLASS="XRef"></A>ADVECTION<STRONG CLASS="Bold">
</STRONG>
</STRONG>
 data block.</P>
<DIV>
<H6 CLASS="FM4thOrderHeading">
<A NAME="50622465_pgfId-637745"></A><A NAME="50622465_22957"></A>Example data block</H6>
<pre CLASS="ComputerInput"><A NAME="50622465_pgfId-545634"></A>Line 0: TRANSPORT</pre>
<pre CLASS="ComputerInput"><A NAME="50622465_pgfId-545635"></A>Line 1:	-cells			5</pre>
<pre CLASS="ComputerInput"><A NAME="50622465_pgfId-545636"></A>Line 2:	-shifts			25</pre>
<pre CLASS="ComputerInput"><A NAME="50622465_pgfId-545637"></A>Line 3:	-time_step			1 yr 2.0</pre>
<pre CLASS="ComputerInput"><A NAME="50622465_pgfId-545638"></A>Line 4:	-flow_direction			forward</pre>
<pre CLASS="ComputerInput"><A NAME="50622465_pgfId-545639"></A>Line 5:	-boundary_conditions			flux constant</pre>
<pre CLASS="ComputerInput"><A NAME="50622465_pgfId-545640"></A>Line 6:	-lengths			4*1.0 2.0</pre>
<pre CLASS="ComputerInput"><A NAME="50622465_pgfId-545641"></A>Line 7:	-dispersivities			4*0.1 0.2</pre>
<pre CLASS="ComputerInput"><A NAME="50622465_pgfId-545642"></A>Line 8:	-correct_disp			true</pre>
<pre CLASS="ComputerInput"><A NAME="50622465_pgfId-545643"></A>Line 9:	-diffusion_coefficient			1.0e-9</pre>
<pre CLASS="ComputerInput"><A NAME="50622465_pgfId-545644"></A>Line 10:	-stagnant			1  6.8e-6   0.3   0.1</pre>
<pre CLASS="ComputerInput"><A NAME="50622465_pgfId-545645"></A>Line 11:	-thermal_diffusion			3.0   0.5e-6</pre>
<pre CLASS="ComputerInput"><A NAME="50622465_pgfId-545646"></A>Line 12:	-initial_time			1000</pre>
<pre CLASS="ComputerInput"><A NAME="50622465_pgfId-545647"></A>Line 13:	-print_cells			1-3 5</pre>
<pre CLASS="ComputerInput"><A NAME="50622465_pgfId-545648"></A>Line 14:	-print_frequency			5</pre>
<pre CLASS="ComputerInput"><A NAME="50622465_pgfId-545649"></A>Line 15:	-punch_cells			2-5</pre>
<pre CLASS="ComputerInput"><A NAME="50622465_pgfId-545650"></A>Line 16:	-punch_frequency			5</pre>
<pre CLASS="ComputerInput"><A NAME="50622465_pgfId-545651"></A>Line 17:	-dump			dump.file</pre>
<pre CLASS="ComputerInput"><A NAME="50622465_pgfId-545652"></A>Line 18:	-dump_frequency			10</pre>
<pre CLASS="ComputerInput"><A NAME="50622465_pgfId-545653"></A>Line 19:	-dump_restart			20</pre>
<pre CLASS="ComputerInput"><A NAME="50622465_pgfId-545654"></A>Line 20:	-warnings			false</pre>
<pre CLASS="ComputerInput"><A NAME="50622465_pgfId-545655"></A>Line 21:	-multi_D			true	1e-9	0.3	0.05	1.0</pre>
<pre CLASS="ComputerInput"><A NAME="50622465_pgfId-545656"></A>Line 22:	-interlayer_D		true	0.09	0.01	250 </pre>
<pre CLASS="ComputerInput"><A NAME="50622465_pgfId-987320"></A><EM CLASS="ChangeFont">Line 23:	-porosities			4*0.3 0.25 </EM>
</pre>
</DIV>
<DIV>
<H6 CLASS="FM4thOrderHeading">
<A NAME="50622465_pgfId-545657"></A><A NAME="50622465_67490"></A>Explanation</H6>
<P CLASS="Body-indent">
<A NAME="50622465_pgfId-545658"></A>Line 0: <STRONG CLASS="Bold">
TRANSPORT</STRONG>
</P>
<P CLASS="Body1">
<A NAME="50622465_pgfId-545659"></A><STRONG CLASS="Bold">
TRANSPORT</STRONG>
 is the keyword for the data block. No other data are input on the keyword line.</P>
<P CLASS="Body-indent">
<A NAME="50622465_pgfId-637730"></A>Line 1: <STRONG CLASS="Bold">
-cells </STRONG>
<EM CLASS="Emphasis">
cells</EM>
</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637731"></A><STRONG CLASS="Bold">
-cells</STRONG>
--Indicates the number of cells in the 1D column for the advective-dispersive transport simulation. Optionally, <STRONG CLASS="Bold">
cells</STRONG>
 or <STRONG CLASS="Bold">
-c</STRONG>
[<STRONG CLASS="Bold">
ells</STRONG>
].</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637723"></A><EM CLASS="Emphasis">
cells</EM>
--Number of cells in a 1D column. Default is 1.</P>
<P CLASS="Body-indent">
<A NAME="50622465_pgfId-637714"></A>Line 2: <STRONG CLASS="Bold">
-shifts </STRONG>
<EM CLASS="Emphasis">
shifts</EM>
</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637715"></A><STRONG CLASS="Bold">
-shifts</STRONG>
--Indicates the number of shifts or diffusion periods in the advective-dispersive transport simulation. Optionally, <STRONG CLASS="Bold">
shifts</STRONG>
 or <STRONG CLASS="Bold">
-s</STRONG>
[<STRONG CLASS="Bold">
hifts</STRONG>
].</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637701"></A><EM CLASS="Emphasis">
shifts</EM>
--For advective-dispersive transport, <EM CLASS="Emphasis">
shifts</EM>
 is the number of advective shifts or time steps, which is the number of times the solution in each cell will be shifted to the next higher or lower numbered cell; the total time simulated is <IMG SRC="phreeqc3-162.png" ALIGN="MIDDLE">
. For purely diffusive transport,<EM CLASS="Emphasis">
 shifts</EM>
 is the number of diffusion periods that are simulated; the total diffusion time is <IMG SRC="phreeqc3-163.png" ALIGN="MIDDLE">
. Default is 1.</P>
<P CLASS="Body-indent">
<A NAME="50622465_pgfId-637686"></A>Line 3: <STRONG CLASS="Bold">
-time_step </STRONG>
<EM CLASS="Emphasis">
time_step [unit] [substeps]</EM>
</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637687"></A><STRONG CLASS="Bold">
-time_step</STRONG>
--Defines time step associated with each advective shift or diffusion period. The number of shifts or diffusion periods is given by <STRONG CLASS="Bold">
-shifts</STRONG>
. Optionally, <STRONG CLASS="Bold">
timest</STRONG>
, <STRONG CLASS="Bold">
-t</STRONG>
[<STRONG CLASS="Bold">
imest</STRONG>
], <STRONG CLASS="Bold">
time_step</STRONG>
, or <STRONG CLASS="Bold">
-t</STRONG>
[<STRONG CLASS="Bold">
ime_step</STRONG>
]. </P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637678"></A><EM CLASS="Emphasis">
time_step</EM>
--Time (second) associated with each shift or diffusion period. Default is 0 s.</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-756859"></A><EM CLASS="Emphasis">
unit</EM>
--Optional time unit may be <STRONG CLASS="Bold">
second</STRONG>
, <STRONG CLASS="Bold">
minute</STRONG>
, <STRONG CLASS="Bold">
hour</STRONG>
, <STRONG CLASS="Bold">
day</STRONG>
, <STRONG CLASS="Bold">
year</STRONG>
, or an abbreviation of one of these units. The time_step is converted to seconds after reading the data block; all internal calculations, Basic functions, and output times are in seconds. Default is second.</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-764792"></A>substeps-- Subdivides the time step into substeps intervals. Used only in multicomponent diffusion calculations, where time_step reduction can help to avoid negative concentrations. The negative concentrations may occur when the time step is too large relative to the explicitly defined stagnant-cell mixing factors; too large a time step causes the Von Neumann criterion to be violated. Default is 1.</P>
<P CLASS="Body-indent">
<A NAME="50622465_pgfId-637660"></A>Line 4: <STRONG CLASS="Bold">
-flow_direction </STRONG>
(<STRONG CLASS="Bold">
forward</STRONG>
, <STRONG CLASS="Bold">
back</STRONG>
, or <STRONG CLASS="Bold">
diffusion_only</STRONG>
)</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637661"></A><STRONG CLASS="Bold">
-flow_direction</STRONG>
--Defines direction of flow. Default is <STRONG CLASS="Bold">
forward </STRONG>
at startup. Optionally, <STRONG CLASS="Bold">
direction</STRONG>
, <STRONG CLASS="Bold">
flow</STRONG>
, <STRONG CLASS="Bold">
flow_direction</STRONG>
, <STRONG CLASS="Bold">
-dir</STRONG>
[<STRONG CLASS="Bold">
ection</STRONG>
], or <STRONG CLASS="Bold">
-f</STRONG>
[<STRONG CLASS="Bold">
low_direction</STRONG>
]. </P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637653"></A><STRONG CLASS="Bold">
forward</STRONG>
, <STRONG CLASS="Bold">
back</STRONG>
, or <STRONG CLASS="Bold">
diffusion_only</STRONG>
--(1) <STRONG CLASS="Bold">
Forward</STRONG>
, advective flow direction is into higher numbered cells; optionally, <STRONG CLASS="Bold">
f</STRONG>
[<STRONG CLASS="Bold">
orward</STRONG>
], (2) <STRONG CLASS="Bold">
Backward</STRONG>
, advective flow direction is into lower numbered cells; optionally <STRONG CLASS="Bold">
b</STRONG>
[<STRONG CLASS="Bold">
ackward</STRONG>
], or (3) <STRONG CLASS="Bold">
Diffusion_only</STRONG>
, only diffusion occurs, there is no advective flow; optionally <STRONG CLASS="Bold">
d</STRONG>
[<STRONG CLASS="Bold">
iffusion_only</STRONG>
] or <STRONG CLASS="Bold">
n</STRONG>
[<STRONG CLASS="Bold">
o_flow</STRONG>
]. </P>
<P CLASS="Body-indent">
<A NAME="50622465_pgfId-637641"></A>Line 5: <STRONG CLASS="Bold">
-boundary_conditions </STRONG>
<EM CLASS="Emphasis">
first, last</EM>
</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-671515"></A><STRONG CLASS="Bold">
-boundary_conditions</STRONG>
--Defines boundary conditions for the first and last cell. Optionally, <STRONG CLASS="Bold">
bc</STRONG>
, <STRONG CLASS="Bold">
bcond</STRONG>
,<STRONG CLASS="Bold">
 -b</STRONG>
[<STRONG CLASS="Bold">
cond</STRONG>
], <STRONG CLASS="Bold">
boundary_condition</STRONG>
,<STRONG CLASS="Bold">
 -b</STRONG>
[<STRONG CLASS="Bold">
oundary_condition</STRONG>
]. Three types of boundary conditions are allowed at either end of the column (indicated by <IMG SRC="phreeqc3-164.png" ALIGN="MIDDLE">
):</P>
<P CLASS="Body2">
<A NAME="50622465_pgfId-671522"></A><STRONG CLASS="Bold">
constant</STRONG>
--Concentration is constant <IMG SRC="phreeqc3-165.png" ALIGN="MIDDLE">
, also known as first type or Dirichlet boundary condition. C<Sub CLASS="Subscript">
0</Sub>
 is the concentration outside the column (mol/kgw). Optionally, <STRONG CLASS="Bold">
co</STRONG>
[<STRONG CLASS="Bold">
nstant</STRONG>
] or <STRONG CLASS="Bold">
1</STRONG>
.</P>
<P CLASS="Body2">
<A NAME="50622465_pgfId-768999"></A><STRONG CLASS="Bold">
closed</STRONG>
--No flux at boundary, v = 0 and <IMG SRC="phreeqc3-166.png" ALIGN="MIDDLE">
, also known as second type or Neumann boundary condition, where v is the flow velocity (m/s, meter per second). Optionally, <STRONG CLASS="Bold">
cl</STRONG>
[<STRONG CLASS="Bold">
osed</STRONG>
] or <STRONG CLASS="Bold">
2</STRONG>
.</P>
<P CLASS="Body2">
<A NAME="50622465_pgfId-637591"></A><STRONG CLASS="Bold">
flux</STRONG>
--Flux boundary condition, <IMG SRC="phreeqc3-167.png" ALIGN="MIDDLE">
, also known as third type or Cauchy boundary condition, where DL is the dispersion coefficient (m2/s). Optionally, <STRONG CLASS="Bold">
f</STRONG>
[<STRONG CLASS="Bold">
lux</STRONG>
] or <STRONG CLASS="Bold">
3</STRONG>
.</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637570"></A><EM CLASS="Emphasis">
first</EM>
--Boundary condition at the first cell, <STRONG CLASS="Bold">
constant</STRONG>
, <STRONG CLASS="Bold">
closed</STRONG>
, or <STRONG CLASS="Bold">
flux</STRONG>
. Default is <STRONG CLASS="Bold">
flux</STRONG>
.</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637571"></A><EM CLASS="Emphasis">
last</EM>
--Boundary condition at the last cell, <STRONG CLASS="Bold">
constant</STRONG>
, <STRONG CLASS="Bold">
closed</STRONG>
, or <STRONG CLASS="Bold">
flux</STRONG>
. Default is <STRONG CLASS="Bold">
flux</STRONG>
.</P>
<P CLASS="Body-indent">
<A NAME="50622465_pgfId-637555"></A>Line 6: <STRONG CLASS="Bold">
-lengths </STRONG>
<EM CLASS="Emphasis">
list of lengths</EM>
</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637545"></A><STRONG CLASS="Bold">
-lengths</STRONG>
--Defines length of each cell for advective-dispersive transport simulations (m). Optionally, <STRONG CLASS="Bold">
length</STRONG>
, <STRONG CLASS="Bold">
lengths</STRONG>
, or <STRONG CLASS="Bold">
-l</STRONG>
[<STRONG CLASS="Bold">
engths</STRONG>
]. </P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637537"></A><EM CLASS="Emphasis">
list of lengths</EM>
--Length of each cell (m). Any number of <EM CLASS="Emphasis">
lengths</EM>
 up to the total number of cells (<EM CLASS="Emphasis">
cells</EM>
) may be entered. If <EM CLASS="Emphasis">
cells</EM>
 is greater than the number of <EM CLASS="Emphasis">
lengths</EM>
 entered, the final value read will be used for the remaining cells. Multiple lines may be used. Repeat factors can be used to input multiple data with the same value; in the Example data block, 4*1.0 is interpreted as 4 values of 1.0. Default is 1 m.</P>
<P CLASS="Body-indent">
<A NAME="50622465_pgfId-637528"></A>Line 7: <STRONG CLASS="Bold">
-dispersivities </STRONG>
<EM CLASS="Emphasis">
list of dispersivities</EM>
</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637529"></A><STRONG CLASS="Bold">
-dispersivities</STRONG>
--Defines dispersivity of each cell for advective-dispersive transport simulations (m). Optionally, <STRONG CLASS="Bold">
disp</STRONG>
, <STRONG CLASS="Bold">
dispersivity</STRONG>
, <STRONG CLASS="Bold">
dispersivities</STRONG>
, <STRONG CLASS="Bold">
-dis</STRONG>
[<STRONG CLASS="Bold">
persivity</STRONG>
], or <STRONG CLASS="Bold">
-dis</STRONG>
[<STRONG CLASS="Bold">
persivities</STRONG>
]. </P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637521"></A><EM CLASS="Emphasis">
list of dispersivities</EM>
--Dispersivity assigned to each cell (m). Any number of <EM CLASS="Emphasis">
dispersivities</EM>
 up to the total number of cells (<EM CLASS="Emphasis">
cells</EM>
) may be entered. If <EM CLASS="Emphasis">
cells</EM>
 is greater than the number of <EM CLASS="Emphasis">
dispersivities</EM>
 entered, the final value read will be used for the remaining cells. Multiple lines may be used. Repeat factors can be used to input multiple data with the same value; in the Example data block, 4*0.1 is interpreted as 4 values of 0.1 m. Default is 0 m.</P>
<P CLASS="Body-indent">
<A NAME="50622465_pgfId-637512"></A>Line 8: <STRONG CLASS="Bold">
-correct_disp</STRONG>
 [(<EM CLASS="Emphasis">
True</EM>
 or <EM CLASS="Emphasis">
False</EM>
)]</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-733888"></A><STRONG CLASS="Bold">
-correct_disp</STRONG>
--Dispersivity is multiplied by (1 + 1/<EM CLASS="Emphasis">
cells</EM>
) for column ends with flux boundary conditions. This correction can improve modeling effluent composition from column experiments that are modeled with few cells. Default is <STRONG CLASS="Bold">
false</STRONG>
 at startup. Optionally, <STRONG CLASS="Bold">
correct_disp</STRONG>
 or <STRONG CLASS="Bold">
-co</STRONG>
[<STRONG CLASS="Bold">
rrect_disp</STRONG>
]. </P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637505"></A>(<EM CLASS="Emphasis">
True</EM>
 or <EM CLASS="Emphasis">
False</EM>
)--<STRONG CLASS="Bold">
True </STRONG>
indicates that dispersivity is corrected for flux-boundary end cells; <STRONG CLASS="Bold">
false </STRONG>
indicates that no correction is made. If neither <STRONG CLASS="Bold">
true</STRONG>
 nor <STRONG CLASS="Bold">
false</STRONG>
 is entered on the line, <STRONG CLASS="Bold">
true</STRONG>
 is assumed. Optionally, <STRONG CLASS="Bold">
t</STRONG>
[<STRONG CLASS="Bold">
rue</STRONG>
] or <STRONG CLASS="Bold">
f</STRONG>
[<STRONG CLASS="Bold">
alse</STRONG>
]. </P>
<P CLASS="Body-indent">
<A NAME="50622465_pgfId-637496"></A>Line 9: <STRONG CLASS="Bold">
-diffusion_coefficient </STRONG>
<EM CLASS="Emphasis">
diffusion coefficient</EM>
</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637497"></A><STRONG CLASS="Bold">
-diffusion_coefficient</STRONG>
--Defines diffusion coefficient for all aqueous species (m<Sup CLASS="Superscript">
2</Sup>
/s) when not using multicomponent diffusion (<STRONG CLASS="Bold">
-multi_D false</STRONG>
); this value of the diffusion coefficient is also used as the default thermal diffusion coefficient (see <STRONG CLASS="Bold">
-thermal_diffusion</STRONG>
). Default is 0.3<EM CLASS="Emphasis">
&#215;</EM>
10<Sup CLASS="Superscript">
-9</Sup>
 m<Sup CLASS="Superscript">
2</Sup>
/s at startup. Optionally, <STRONG CLASS="Bold">
diffusion_coefficient</STRONG>
, <STRONG CLASS="Bold">
diffc</STRONG>
, <STRONG CLASS="Bold">
-dif</STRONG>
[<STRONG CLASS="Bold">
fusion_coefficient</STRONG>
], or <STRONG CLASS="Bold">
-dif</STRONG>
[<STRONG CLASS="Bold">
fc</STRONG>
]. </P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637482"></A><EM CLASS="Emphasis">
diffusion coefficient</EM>
--Diffusion coefficient. </P>
<P CLASS="Body-indent">
<A NAME="50622465_pgfId-637489"></A>Line 10: <STRONG CLASS="Bold">
-stagnant </STRONG>
<EM CLASS="Emphasis">
stagnant_cells </EM>
[<EM CLASS="Emphasis">
exchange_factor <IMG SRC="phreeqc3-168.png" ALIGN="MIDDLE">
 <IMG SRC="phreeqc3-169.png" ALIGN="MIDDLE">
</EM>
]</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637422"></A><STRONG CLASS="Bold">
-stagnant</STRONG>
--Defines the maximum number of stagnant (immobile) cells associated with each cell in which advection occurs (mobile cell). Each mobile cell may be connected with up to <EM CLASS="Emphasis">
stagnant_cells </EM>
immobile cells. The immobile cells associated with a mobile cell are usually conceived to be a 1D column of cells in which solutes from the mobile cell diffuse laterally. However, the connections among the immobile cells can be defined freely with <A HREF="phreeqc3-27.htm#50622465_23725" CLASS="XRef">MIX</A> data blocks, which allows calculation of multidimensional diffusion processes (Appelo and Wersin, 2007) and radial diffusion (Appelo and others, 2008, see <A HREF="phreeqc3-76.htm#50622479_68313" CLASS="XRef">See Modeling Diffusion of HTO, 36Cl-, 22Na+, and Cs+ in a Radial Diffusion Cell</A>). The immobile cells associated with a mobile cell, <EM CLASS="Emphasis">
cell</EM>
, are numbered as follows: <IMG SRC="phreeqc3-170.png" ALIGN="MIDDLE">
, where <EM CLASS="Emphasis">
cells </EM>
is the number of mobile cells and <IMG SRC="phreeqc3-171.png" ALIGN="MIDDLE">
. For each immobile cell, a solution (<A HREF="phreeqc3-41.htm#50622465_89789" CLASS="XRef">SOLUTION</A>, <A HREF="phreeqc3-44.htm#50622465_84297" CLASS="XRef">SOLUTION_SPREAD</A>, or <A HREF="phreeqc3-37.htm#50622465_81857" CLASS="XRef">SAVE</A> data block) must be defined, and either a <A HREF="phreeqc3-27.htm#50622465_23725" CLASS="XRef">MIX</A> data block or, for the first-order exchange model, the <EM CLASS="Emphasis">
exchange_factor</EM>
 must be defined (only applicable if <EM CLASS="Emphasis">
stagnant_cells</EM>
 equals 1). Mixing will be performed at each diffusion/dispersion time step. <A HREF="phreeqc3-13.htm#50622465_61207" CLASS="XRef">EQUILIBRIUM_PHASES</A>, <A HREF="phreeqc3-14.htm#50622465_49135" CLASS="XRef">EXCHANGE</A>, <A HREF="phreeqc3-17.htm#50622465_83409" CLASS="XRef">GAS_PHASE</A>, <A HREF="phreeqc3-24.htm#50622465_55637" CLASS="XRef">KINETICS</A>, <A HREF="phreeqc3-33.htm#50622465_75635" CLASS="XRef">REACTION</A>, <A HREF="phreeqc3-35.htm#50622465_75016" CLASS="XRef">REACTION_TEMPERATURE</A>, <A HREF="phreeqc3-40.htm#50622465_77444" CLASS="XRef">SOLID_SOLUTIONS</A>, and <A HREF="phreeqc3-45.htm#50622465_56392" CLASS="XRef">SURFACE</A> may be defined for an immobile cell. Thermal diffusion in excess of hydrodynamic diffusion can be calculated only for the first-order exchange model. Optionally, <STRONG CLASS="Bold">
stagnant</STRONG>
 or <STRONG CLASS="Bold">
-st</STRONG>
[<STRONG CLASS="Bold">
agnant</STRONG>
].</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637357"></A><EM CLASS="Emphasis">
stagnant_cells</EM>
--Maximum number of stagnant (immobile) cells associated with a mobile cell. Default is 0.</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637259"></A><EM CLASS="Emphasis">
exchange_factor</EM>
--Factor describing exchange between a mobile and its immobile cell (s<Sup CLASS="Superscript">
-1</Sup>
). The <EM CLASS="Emphasis">
exchange_factor</EM>
 can be used only if <EM CLASS="Emphasis">
stagnant_cells</EM>
 is 1, in which case all immobile cells have the same diffusion properties. WARNING: If <EM CLASS="Emphasis">
exchange_factor </EM>
is entered, all previously defined <STRONG CLASS="Bold">
MIX</STRONG>
 structures will be deleted and <STRONG CLASS="Bold">
MIX</STRONG>
 structures for the first-order exchange model for a dual porosity medium will be created. Default is 0 s<Sup CLASS="Superscript">
-1</Sup>
.</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-766675"></A><EM CLASS="Emphasis">
<IMG SRC="phreeqc3-172.png" ALIGN="MIDDLE">
</EM>
--Porosity in each mobile cell, expressed as a fraction of the total volume of mobile and immobile cells. The <EM CLASS="Emphasis">
<IMG SRC="phreeqc3-173.png" ALIGN="MIDDLE">
</EM>
 is used only if <EM CLASS="Emphasis">
stagnant_cells</EM>
 is 1, in which case all mobile cells have the same porosity. Default is 0 (unitless).</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-766682"></A><EM CLASS="Emphasis">
<IMG SRC="phreeqc3-174.png" ALIGN="MIDDLE">
</EM>
--Porosity in each immobile cell, expressed as a fraction of the total volume of mobile and immobile cells. The <EM CLASS="Emphasis">
<IMG SRC="phreeqc3-175.png" ALIGN="MIDDLE">
</EM>
 is used only if <EM CLASS="Emphasis">
stagnant_cells</EM>
 is 1, in which case all immobile cells have the same porosity. Default is 0 (unitless).</P>
<P CLASS="Body-indent">
<A NAME="50622465_pgfId-766653"></A>Line 11: <STRONG CLASS="Bold">
-thermal_diffusion</STRONG>
<EM CLASS="Emphasis">
 temperature retardation factor, thermal diffusion coefficient</EM>
</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-766610"></A><STRONG CLASS="Bold">
-thermal_diffusion</STRONG>
--Defines parameters for calculating the diffusive part of heat transport. Diffusive heat transport will be calculated as a separate process if the temperature in any of the solutions of the transport domain differs by more than 1 &#176;C, and when the <EM CLASS="Emphasis">
thermal diffusion coefficient</EM>
 is larger than the effective (aqueous) <EM CLASS="Emphasis">
diffusion coefficient</EM>
. Otherwise, diffusive heat transport is calculated as a part of aqueous diffusion. The <EM CLASS="Emphasis">
temperature retardation factor</EM>
, R<Sub CLASS="Subscript">
T</Sub>
, is defined as the ratio of the heat capacity of the total aquifer over the heat capacity of water in the pores, <IMG SRC="phreeqc3-176.png" ALIGN="MIDDLE">
, where <IMG SRC="phreeqc3-177.png" ALIGN="MIDDLE">
 is the water filled porosity, <IMG SRC="phreeqc3-178.png" ALIGN="MIDDLE">
 is density (kg/m<Sup CLASS="Superscript">
3</Sup>
, kilogram per cubic meter), <EM CLASS="Emphasis">
k</EM>
 is specific heat (kJ&#176;C<Sup CLASS="Superscript">
-1</Sup>
kg<Sup CLASS="Superscript">
-1</Sup>
), and subscripts <EM CLASS="Emphasis">
w</EM>
 and <EM CLASS="Emphasis">
s</EM>
 indicate water and solid, respectively. The thermal diffusion coefficient, <IMG SRC="phreeqc3-179.png" ALIGN="MIDDLE">
, can be estimated by using <IMG SRC="phreeqc3-180.png" ALIGN="MIDDLE">
, where <IMG SRC="phreeqc3-181.png" ALIGN="MIDDLE">
 is the heat conductivity of the aquifer, including pore water and solid (kJ&#176;C<Sup CLASS="Superscript">
-1</Sup>
m<Sup CLASS="Superscript">
-1</Sup>
s<Sup CLASS="Superscript">
-1</Sup>
, kilojoule per degree Celsius, per meter per second). The value of <IMG SRC="phreeqc3-182.png" ALIGN="MIDDLE">
 may be 100 to 1500 times larger than the aqueous diffusion coefficient, or about 1<EM CLASS="Emphasis">
&#215;</EM>
10<Sup CLASS="Superscript">
-6</Sup>
 m<Sup CLASS="Superscript">
2</Sup>
/s. A temperature change during transport is reduced by the temperature retardation factor (unitless) to account for the heat capacity of the matrix. Optionally, <STRONG CLASS="Bold">
-th</STRONG>
[<STRONG CLASS="Bold">
ermal_diffusion</STRONG>
].</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-766632"></A><EM CLASS="Emphasis">
temperature retardation factor</EM>
--Temperature retardation factor, unitless. Default is 2.0 (unitless).</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-766633"></A><EM CLASS="Emphasis">
thermal diffusion coefficient</EM>
--Thermal diffusion coefficient. Default is the aqueous diffusion coefficient.</P>
<P CLASS="Body-indent">
<A NAME="50622465_pgfId-637109"></A>Line 12: <STRONG CLASS="Bold">
-initial_time </STRONG>
<EM CLASS="Emphasis">
initial_time</EM>
</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637110"></A><STRONG CLASS="Bold">
-initial_time</STRONG>
--Identifier to set the time at the beginning of a transport simulation. The identifier sets the initial value of the variable controlled by <STRONG CLASS="Bold">
-time</STRONG>
 in the <A HREF="phreeqc3-38.htm#50622465_20239" CLASS="XRef">SELECTED_OUTPUT</A> data block. Optionally, <STRONG CLASS="Bold">
initial_time</STRONG>
 or <STRONG CLASS="Bold">
-i</STRONG>
[<STRONG CLASS="Bold">
nitial_time</STRONG>
]. </P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637096"></A><EM CLASS="Emphasis">
initial_time</EM>
--Time (seconds) at the beginning of the transport simulation. Default is the cumulative time including all preceding <A HREF="phreeqc3-6.htm#50622465_87438" CLASS="XRef">ADVECTION</A> simulations (for which <STRONG CLASS="Bold">
-time_step</STRONG>
 has been defined) and all preceding <A HREF="phreeqc3-49.htm#50622465_87317" CLASS="XRef">TRANSPORT</A> simulations.</P>
<P CLASS="Body-indent">
<A NAME="50622465_pgfId-637075"></A>Line 13: <STRONG CLASS="Bold">
-print_cells </STRONG>
<EM CLASS="Emphasis">
list of cell numbers</EM>
</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637076"></A><STRONG CLASS="Bold">
-print_cells</STRONG>
--Identifier to select cells for which results will be written to the output file. Optionally, <STRONG CLASS="Bold">
print</STRONG>
, <STRONG CLASS="Bold">
print_cells</STRONG>
, or <STRONG CLASS="Bold">
-pr</STRONG>
[<STRONG CLASS="Bold">
int_cells</STRONG>
]. Note that the hyphen is required to avoid a conflict with the keyword <A HREF="phreeqc3-31.htm#50622465_92102" CLASS="XRef">PRINT</A>.</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637065"></A><EM CLASS="Emphasis">
list of cell numbers</EM>
--Printing to the output file will occur only for these cell numbers. The list of cell numbers may be continued on the succeeding line(s). A range of cell numbers may be included in the list in the form <EM CLASS="Emphasis">
m-n</EM>
, where <EM CLASS="Emphasis">
m</EM>
 and <EM CLASS="Emphasis">
n</EM>
 are positive integers, <EM CLASS="Emphasis">
m</EM>
 is less than <EM CLASS="Emphasis">
n</EM>
, and the two numbers are separated by a hyphen without intervening spaces. Default is 1-<EM CLASS="Emphasis">
cells</EM>
.</P>
<P CLASS="Body-indent">
<A NAME="50622465_pgfId-637050"></A>Line 14: <STRONG CLASS="Bold">
-print_frequency </STRONG>
<EM CLASS="Emphasis">
print_modulus</EM>
</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637051"></A><STRONG CLASS="Bold">
-print_frequency</STRONG>
--Identifier to select shifts for which results will be written to the output file. Optionally, <STRONG CLASS="Bold">
print_frequency</STRONG>
, <STRONG CLASS="Bold">
-print_f</STRONG>
[<STRONG CLASS="Bold">
requency</STRONG>
], <STRONG CLASS="Bold">
output_frequency</STRONG>
, or <STRONG CLASS="Bold">
-o</STRONG>
[<STRONG CLASS="Bold">
utput_frequency</STRONG>
]. </P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637043"></A><EM CLASS="Emphasis">
print_modulus</EM>
--Printing to the output file will occur for advection shifts or diffusion periods that are evenly divisible by <EM CLASS="Emphasis">
print_modulus</EM>
. Default is 1.</P>
<P CLASS="Body-indent">
<A NAME="50622465_pgfId-637034"></A>Line 15: <STRONG CLASS="Bold">
-punch_cells </STRONG>
<EM CLASS="Emphasis">
list of cell numbers</EM>
</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637035"></A><STRONG CLASS="Bold">
-punch_cells</STRONG>
--Identifier to select cells for which results will be written to the selected-output file. Optionally, <STRONG CLASS="Bold">
punch</STRONG>
,<STRONG CLASS="Bold">
 punch_cells</STRONG>
, <STRONG CLASS="Bold">
-pu</STRONG>
[<STRONG CLASS="Bold">
nch_cells</STRONG>
], <STRONG CLASS="Bold">
selected_cells</STRONG>
, or <STRONG CLASS="Bold">
-selected_c</STRONG>
[<STRONG CLASS="Bold">
ells</STRONG>
]. </P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-661621"></A><EM CLASS="Emphasis">
list of cell numbers</EM>
--Printing to the selected-output file will occur only for these cell numbers. The list of cell numbers may be continued on the succeeding line(s). A range of cell numbers may be included in the list in the form <EM CLASS="Emphasis">
m-n</EM>
, where <EM CLASS="Emphasis">
m</EM>
 and <EM CLASS="Emphasis">
n</EM>
 are positive integers, <EM CLASS="Emphasis">
m</EM>
 is less than <EM CLASS="Emphasis">
n</EM>
, and the two numbers are separated by a hyphen without intervening spaces. Default is 1-<EM CLASS="Emphasis">
cells</EM>
.</P>
<P CLASS="Body-indent">
<A NAME="50622465_pgfId-661622"></A>Line 16: <STRONG CLASS="Bold">
-punch_frequency </STRONG>
<EM CLASS="Emphasis">
punch_modulus</EM>
</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637019"></A><STRONG CLASS="Bold">
-punch_frequency</STRONG>
--Identifier to select shifts for which results will be written to the selected-output file. Optionally, <STRONG CLASS="Bold">
punch_frequency</STRONG>
, <STRONG CLASS="Bold">
-punch_f</STRONG>
[<STRONG CLASS="Bold">
requency</STRONG>
], <STRONG CLASS="Bold">
selected_output_frequency</STRONG>
, <STRONG CLASS="Bold">
-selected_o</STRONG>
[<STRONG CLASS="Bold">
utput_frequency</STRONG>
]. </P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637011"></A><EM CLASS="Emphasis">
punch_modulus</EM>
--Printing to the selected-output file will occur for advection shifts or diffusion periods that are evenly divisible by <EM CLASS="Emphasis">
punch_modulus</EM>
. Default is 1.</P>
<P CLASS="Body-indent">
<A NAME="50622465_pgfId-637002"></A>Line 17: <STRONG CLASS="Bold">
-dump </STRONG>
<EM CLASS="Emphasis">
dump file</EM>
</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-637003"></A><STRONG CLASS="Bold">
-dump</STRONG>
--Identifier to write a complete state of the advective-dispersive transport simulation to <EM CLASS="Emphasis">
dump file </EM>
after every <EM CLASS="Emphasis">
dump_modulus</EM>
 advection shifts or diffusion periods. The file is formatted as an input file that can be used to restart calculations. Previous contents of the file are overwritten each time the file is written. Optionally, <STRONG CLASS="Bold">
dump</STRONG>
 or <STRONG CLASS="Bold">
-du</STRONG>
[<STRONG CLASS="Bold">
mp</STRONG>
].</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-636995"></A><EM CLASS="Emphasis">
dump file</EM>
--Name of the file to which complete state of the advective-dispersive transport simulation will be written. Default is <EM CLASS="Emphasis">
phreeqc.dmp</EM>
.</P>
<P CLASS="Body-indent">
<A NAME="50622465_pgfId-636986"></A>Line 18: <STRONG CLASS="Bold">
-dump_frequency </STRONG>
<EM CLASS="Emphasis">
dump_modulus</EM>
</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-636987"></A><STRONG CLASS="Bold">
-dump_frequency</STRONG>
--Complete state of the advective-dispersive transport simulation will be written to the dump file for advection shifts or diffusion periods that are evenly divisible by <EM CLASS="Emphasis">
dump_modulus</EM>
. Optionally, <STRONG CLASS="Bold">
dump_frequency</STRONG>
 or <STRONG CLASS="Bold">
-dump_f</STRONG>
[<STRONG CLASS="Bold">
requency</STRONG>
]. </P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-636979"></A><EM CLASS="Emphasis">
dump_modulus</EM>
--<EM CLASS="Emphasis">
Number of</EM>
 advection shifts or diffusion periods. Default is <EM CLASS="Emphasis">
shifts</EM>
/2 or 1, whichever is larger.</P>
<P CLASS="Body-indent">
<A NAME="50622465_pgfId-636970"></A>Line 19: <STRONG CLASS="Bold">
-dump_restart </STRONG>
<EM CLASS="Emphasis">
shift number</EM>
</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-636971"></A><STRONG CLASS="Bold">
-dump_restart</STRONG>
--If an advective-dispersive transport simulation is restarted from a dump file, the starting shift number is given on this line. Optionally, <STRONG CLASS="Bold">
dump_restart</STRONG>
 or <STRONG CLASS="Bold">
-dump_r</STRONG>
[<STRONG CLASS="Bold">
estart</STRONG>
]. </P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-636963"></A><EM CLASS="Emphasis">
shift number</EM>
--Starting shift number for the calculations, if restarting from a dump file. The shift number is written in the dump file by PHREEQC. It equals the shift number at which the dump file was created. Default is 1.</P>
<P CLASS="Body-indent">
<A NAME="50622465_pgfId-636954"></A>Line 20: <STRONG CLASS="Bold">
-warnings </STRONG>
[(<EM CLASS="Emphasis">
True</EM>
 or <EM CLASS="Emphasis">
False</EM>
)]</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-636955"></A><STRONG CLASS="Bold">
-warnings</STRONG>
--Identifier enables or disables printing of warning messages for transport calculations. In some cases, transport calculations could produce many warnings, which are not errors. Once it is determined that the warnings are not due to erroneous input, disabling the warning messages can avoid generating large output files. Default is <STRONG CLASS="Bold">
true</STRONG>
 at startup. Optionally, <STRONG CLASS="Bold">
warnings</STRONG>
, <STRONG CLASS="Bold">
warning</STRONG>
, or <STRONG CLASS="Bold">
-w</STRONG>
[<STRONG CLASS="Bold">
arnings</STRONG>
]. </P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-636947"></A>(<EM CLASS="Emphasis">
True</EM>
 or <EM CLASS="Emphasis">
False</EM>
)--If <STRONG CLASS="Bold">
true</STRONG>
, warning messages are printed to the screen and the output file; if <STRONG CLASS="Bold">
false</STRONG>
, warning messages are not printed to the screen nor the output file. The value set with <STRONG CLASS="Bold">
-warnings</STRONG>
 is retained in all subsequent transport simulations until changed. If neither <STRONG CLASS="Bold">
true</STRONG>
 nor <STRONG CLASS="Bold">
false</STRONG>
 is entered on the line, <STRONG CLASS="Bold">
true</STRONG>
 is assumed. Optionally, <STRONG CLASS="Bold">
t</STRONG>
[<STRONG CLASS="Bold">
rue</STRONG>
] or <STRONG CLASS="Bold">
f</STRONG>
[<STRONG CLASS="Bold">
alse</STRONG>
].</P>
<P CLASS="Body-indent">
<A NAME="50622465_pgfId-636935"></A>Line 21: <STRONG CLASS="Bold">
-multi_D </STRONG>
(<EM CLASS="Emphasis">
True </EM>
or <EM CLASS="Emphasis">
False</EM>
) <EM CLASS="Emphasis">
 default_Dw  porosity  porosity_limit  Archie_n</EM>
</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-929460"></A><STRONG CLASS="Bold">
-multi_D</STRONG>
--Enables or disables the calculation of multicomponent diffusion. In multicomponent diffusion each solute can be given its own diffusion coefficient, allowing it to diffuse at its own rate, but with the constraint that overall charge balance is maintained (Vinograd and McBain, 1941; Appelo and Wersin, 2007), Optionally, <STRONG CLASS="Bold">
multi_D</STRONG>
 or <STRONG CLASS="Bold">
-m</STRONG>
[<STRONG CLASS="Bold">
ulti_D</STRONG>
] (as with all identifiers, case insensitive). With <STRONG CLASS="Bold">
-multi_D true</STRONG>
<EM CLASS="Emphasis">
, the diffusive flux is calculated by (see also Notes):</EM>
</P>
<P CLASS="Body2">
<A NAME="50622465_pgfId-719675"></A><EM CLASS="Emphasis">
 <IMG SRC="phreeqc3-183.png" ALIGN="MIDDLE">
</EM>
,</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-765392"></A>where<EM CLASS="Emphasis">
 i </EM>
indicates the species; <EM CLASS="Emphasis">
Ji is the flux (mol m</EM>
<Sup CLASS="Superscript">
-2</Sup>
<EM CLASS="Emphasis">
s</EM>
<Sup CLASS="Superscript">
-1</Sup>
<EM CLASS="Emphasis">
, </EM>
mole per square meter per second); <IMG SRC="phreeqc3-184.png" ALIGN="MIDDLE">
<EM CLASS="Emphasis">
 is the (temperature corrected) tracer diffusion coefficient (m</EM>
<Sup CLASS="Superscript">
2</Sup>
<EM CLASS="Emphasis">
/s); &#949; </EM>
is the water-filled (or accessible) porosity (unitless);<EM CLASS="Emphasis">
 n </EM>
is an empirical exponent, known from Archie&#8217;s law to be about 1; <EM CLASS="Emphasis">
&#947;</EM>
<Sub CLASS="Subscript">
i</Sub>
<EM CLASS="Emphasis">
 </EM>
is the activity-coefficient (unitless); <EM CLASS="Emphasis">
ci </EM>
is the concentration (mol/m<Sup CLASS="Superscript">
3</Sup>
, mole per cubic meter); grad(<EM CLASS="Emphasis">
ci</EM>
) is the concentration gradient (mol/m<Sup CLASS="Superscript">
4</Sup>
, mole per meter to the fourth power)<EM CLASS="Emphasis">
, </EM>
which may be different in free (uncharged) pore water and in the Donnan pore space on a surface (see Notes); and <EM CLASS="Emphasis">
CBti </EM>
is the charge balance term (Appelo and Wersin, 2007, see the Notes).<EM CLASS="Emphasis">
 </EM>
The tracer diffusion coefficients are defined with keyword <EM CLASS="Emphasis">
<A HREF="phreeqc3-43.htm#50622465_96148" CLASS="XRef"></A>SOLUTION_SPECIES<EM CLASS="Emphasis">
</EM>
 </EM>
in <EM CLASS="Emphasis">
phreeqc.dat </EM>
for 25 &#176;C, and corrected to temperature T (K) of the solution as follows:</P>
<P CLASS="Body2">
<A NAME="50622465_pgfId-547599"></A>D<Sub CLASS="Subscript">
w</Sub>
' =<EM CLASS="Emphasis">
 (D</EM>
<Sub CLASS="Subscript">
w</Sub>
)298 <EM CLASS="Emphasis">
 &#215; <IMG SRC="phreeqc3-185.png" ALIGN="MIDDLE">
 &#215; <IMG SRC="phreeqc3-186.png" ALIGN="MIDDLE">
, </EM>
</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-545849"></A>where <EM CLASS="Emphasis">
&#951; </EM>
is the viscosity of water.</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-662139"></A>When <STRONG CLASS="Bold">
-multi_D</STRONG>
 is <STRONG CLASS="Bold">
false</STRONG>
, the diffusive flux is calculated with <EM CLASS="Emphasis">
J</EM>
<Sub CLASS="Subscript">
i</Sub>
<EM CLASS="Emphasis">
 = - D</EM>
<Sub CLASS="Subscript">
p</Sub>
<EM CLASS="Emphasis">
 &#215; </EM>
grad(<EM CLASS="Emphasis">
c</EM>
<Sub CLASS="Subscript">
i</Sub>
), where<EM CLASS="Emphasis">
 D</EM>
<Sub CLASS="Subscript">
p</Sub>
<EM CLASS="Emphasis">
 </EM>
is the same for all species (defined with identifier <STRONG CLASS="Bold">
-diffusion_coefficient</STRONG>
 as in Line 9) and not corrected for changes of temperature.</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-737046"></A>Note that PHREEQC assumes that, for diffusion, the cell contains water exclusively, and uses the pore water diffusion coefficient for calculating the flux. (The effective diffusion coefficient (D<Sub CLASS="Subscript">
e</Sub>
) is for a volume of grains and pores together, and is related to <EM CLASS="Emphasis">
D</EM>
<Sub CLASS="Subscript">
p</Sub>
 as follows: D<Sub CLASS="Subscript">
e</Sub>
 = D<Sub CLASS="Subscript">
p</Sub>
 <EM CLASS="Emphasis">
&#949;</EM>
). The identifier <STRONG CLASS="Bold">
-stagnant</STRONG>
 allows for nonuniform porosities, nonuniform tortuosities, and other variations in the diffusion domain, provided mixing factors among cells are defined explicitly in the input file with <EM CLASS="Emphasis">
<A HREF="phreeqc3-27.htm#50622465_23725" CLASS="XRef"></A>MIX<EM CLASS="Emphasis">
</EM>
</EM>
 data blocks.</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-636925"></A>(<EM CLASS="Emphasis">
True</EM>
 or <EM CLASS="Emphasis">
False</EM>
)--If <STRONG CLASS="Bold">
true</STRONG>
, multicomponent diffusion is calculated; if <STRONG CLASS="Bold">
false</STRONG>
, diffusion is calculated with the diffusion coefficient given in Line 9<EM CLASS="Emphasis">
.</EM>
</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-636914"></A><EM CLASS="Emphasis">
default_Dw</EM>
--The diffusion coefficient (m<Sup CLASS="Superscript">
2</Sup>
/s at 25 &#176;C) given to solute species for which <STRONG CLASS="Bold">
-dw</STRONG>
 is not defined in keyword<EM CLASS="Emphasis">
 <A HREF="phreeqc3-43.htm#50622465_96148" CLASS="XRef"></A>SOLUTION_SPECIES<EM CLASS="Emphasis">
</EM>
. T</EM>
he value must be used when calculating explicit mixing factors for stagnant cells. Default is 0 m<Sup CLASS="Superscript">
2</Sup>
/s.</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-766568"></A><EM CLASS="Emphasis">
porosity</EM>
--The porosity filled with free and Donnan pore water in the cells; the <EM CLASS="Emphasis">
porosity</EM>
 is a fraction of a representative volume of the porous medium (unitless). Initially all cells are defined with the same <EM CLASS="Emphasis">
porosity</EM>
. The porosity for a cell can be changed in any keyword data block that supports Basic programming (<A HREF="phreeqc3-32.htm#50622465_97907" CLASS="XRef">RATES</A>, <A HREF="phreeqc3-51.htm#50622465_26121" CLASS="XRef">USER_GRAPH</A>, <A HREF="phreeqc3-52.htm#50622465_55085" CLASS="XRef">USER_PRINT</A>, and <A HREF="phreeqc3-53.htm#50622465_56415" CLASS="XRef">USER_PUNCH</A>) by using the PHREEQC Basic function CHANGE_POR(porosity, cell_no). The porosity in a cell can be retrieved with the function GET_POR(cell_no). Default is 0 (unitless). </P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-766581"></A><EM CLASS="Emphasis">
porosity_limit</EM>
--The porosity limit, below which diffusion stops. Default is 0 (unitless).</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-766546"></A><EM CLASS="Emphasis">
Archie_n</EM>
--The exponent n used for calculating the pore-water diffusion coefficient (D<Sub CLASS="Subscript">
p, i</Sub>
) from the tracer diffusion coefficient (D<Sub CLASS="Subscript">
w, i</Sub>
), Dp, i = Dw, i <EM CLASS="Emphasis">
&#949;</EM>
n, where <EM CLASS="Emphasis">
&#949;</EM>
 is the water filled (or the accessible) porosity (unitless), and n is an empirical exponent that varies from approximately 0.9 to 1.2 (Grathwohl, 1998; Van Loon and others, 2007) but may be higher for diffusion perpendicular to the bedding plane. The parameter <IMG SRC="phreeqc3-187.png" ALIGN="MIDDLE">
 (approximately 1 / <EM CLASS="Emphasis">
&#949;</EM>
wn) is the tortuosity factor, which accounts for the longer diffusion path for a particle in a porous media than in pure water. </P>
<P CLASS="Body-indent">
<A NAME="50622465_pgfId-636816"></A>Line 22: <STRONG CLASS="Bold">
-interlayer_D </STRONG>
 (<EM CLASS="Emphasis">
True</EM>
 or<EM CLASS="Emphasis">
 False</EM>
)  <EM CLASS="Emphasis">
interlayer_porosity  interlayer_porosity_limit  interlayer_tortuosity_factor</EM>
</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-931424"></A><STRONG CLASS="Bold">
-interlayer_D</STRONG>
--Enables or disables the calculation of interlayer diffusion in swelling clay minerals. If <STRONG CLASS="Bold">
-interlayer_D</STRONG>
 is <STRONG CLASS="Bold">
true</STRONG>
, <STRONG CLASS="Bold">
-multi_D</STRONG>
 also must be <STRONG CLASS="Bold">
true</STRONG>
, and the <STRONG CLASS="Bold">
-multi_D</STRONG>
 parameters must be set as explained with Line 21. Optionally, <STRONG CLASS="Bold">
interlayer_D</STRONG>
 or <STRONG CLASS="Bold">
-int</STRONG>
[<STRONG CLASS="Bold">
erlayer_D</STRONG>
] (as with all identifiers, case insensitive). The flux in the interlayers is calculated for the cations associated with X- (as defined with keyword <A HREF="phreeqc3-14.htm#50622465_84573" CLASS="XRef">EXCHANGE</A>): <BR>
Ji = -<EM CLASS="Emphasis">
 <IMG SRC="phreeqc3-188.png" ALIGN="MIDDLE">
</EM>
 <EM CLASS="Emphasis">
&#215; </EM>
mCEC <EM CLASS="Emphasis">
&#215;</EM>
 grad(<EM CLASS="Emphasis">
&#946;&#953;</EM>
) + CBti, </P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-636787"></A>where, i indicates an aqueous species, Ji<EM CLASS="Emphasis">
 </EM>
is the flux (mol m<Sup CLASS="Superscript">
-2</Sup>
s<Sup CLASS="Superscript">
-1</Sup>
), Dw',i is the temperature corrected diffusion coefficient, <EM CLASS="Emphasis">
<IMG SRC="phreeqc3-189.png" ALIGN="MIDDLE">
</EM>
 is the interlayer tortuosity factor (unitless), mCEC is the concentration of total X-, mol(X-) / (m3 interlayer water), where (m3 interlayer water) = (m3 free pore water + m3 Donnan water) <EM CLASS="Emphasis">
&#215;</EM>
 (<EM CLASS="Emphasis">
&#949;IL</EM>
 / <EM CLASS="Emphasis">
&#949;</EM>
), grad(<EM CLASS="Emphasis">
&#946;&#953;</EM>
) is the gradient of the equivalent fraction of species i on the exchange sites (1/m), and CBti is the charge balance term (Appelo and Wersin, 2007). The tracer diffusion coefficients are defined with keyword <EM CLASS="Emphasis">
<A HREF="phreeqc3-43.htm#50622465_96148" CLASS="XRef"></A>SOLUTION_SPECIES<EM CLASS="Emphasis">
</EM>
 </EM>
in <EM CLASS="Emphasis">
phreeqc.dat </EM>
for 25 &#176;C and are corrected to temperature <EM CLASS="Emphasis">
T </EM>
(K) of the solution with the equation<EM CLASS="Emphasis">
 </EM>
Dw' =<EM CLASS="Emphasis">
 (Dw</EM>
)298 <EM CLASS="Emphasis">
 &#215; <IMG SRC="phreeqc3-190.png" ALIGN="MIDDLE">
 &#215; <IMG SRC="phreeqc3-191.png" ALIGN="MIDDLE">
</EM>
, where <EM CLASS="Emphasis">
&#951; </EM>
is the viscosity of water. </P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-636803"></A>(<EM CLASS="Emphasis">
True</EM>
 or <EM CLASS="Emphasis">
False</EM>
)--If <STRONG CLASS="Bold">
true</STRONG>
, interlayer diffusion is calculated; if <STRONG CLASS="Bold">
false</STRONG>
, interlayer diffusion is not calculated<EM CLASS="Emphasis">
. </EM>
</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-636765"></A><EM CLASS="Emphasis">
interlayer_porosity</EM>
--The porosity of interlayer water, a fraction of the total volume<EM CLASS="Emphasis">
. </EM>
Default is 0 (unitless)<EM CLASS="Emphasis">
.</EM>
</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-636757"></A><EM CLASS="Emphasis">
interlayer_porosity_limit</EM>
--The porosity of interlayer water, below which interlayer diffusion stops. Default is 0 (unitless). </P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-636749"></A><EM CLASS="Emphasis">
interlayer_tortuosity_factor</EM>
--The tortuosity factor for interlayer diffusion, <EM CLASS="Emphasis">
<IMG SRC="phreeqc3-192.png" ALIGN="MIDDLE">
</EM>
 (unitless). Default is 100.0.</P>
<P CLASS="Body-indent">
<A NAME="50622465_pgfId-987370"></A><EM CLASS="ChangeFont">
Line 23: -porosities list of porosities</EM>
</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-987371"></A><EM CLASS="ChangeFont">
-porosities--Defines porosity of each cell for diffusive transport simulations (m). Optionally, po[rosities] or -po[rosity]. </EM>
</P>
<P CLASS="Body1-indent">
<A NAME="50622465_pgfId-987372"></A><EM CLASS="ChangeFont">
list of porosities--Porosity of each cell (unitless). Any number of porosities up to the total number of cells (cells) may be entered. If cells is greater than the number of lengths entered, the final value read will be used for the remaining cells. Multiple lines may be used. Repeat factors can be used to input multiple data with the same value; in the Example data block, 4*0.30 is interpreted as 4 values of 0.30. The values entered here take pecedence ofver the value given with -multi_D. If one stangant layer is defined together with an exchange-factor &gt; 0 (&#8216;-stagnant 1 4e-6 0.3 0.1&#8217;), the mobile (here = 0.3) and immobile (here = 0.1) porosities defined with -stagnant are used. Default is 1 m.</EM>
</P>
</DIV>
<DIV>
<H6 CLASS="FM4thOrderHeading">
<A NAME="50622465_pgfId-545877"></A><A NAME="50622465_44571"></A>Notes</H6>
<P CLASS="BodyText">
<A NAME="50622465_pgfId-663308"></A>The advective-dispersive transport capabilities of PHREEQC are derived from a formulation of 1D, advective-dispersive transport presented by Appelo and Postma (2005). The 1D column is defined by a series of cells (number of cells is <EM CLASS="Emphasis">
cells</EM>
), each of which has the same pore volume. Lengths are defined for each cell and the time step (<EM CLASS="Emphasis">
time step</EM>
) gives the time necessary for a pore volume of water to move through each cell. Thus, the velocity of water in each cell is determined by the length of the cell divided by the time step. In the Example data block, a column of five cells (<EM CLASS="Emphasis">
cells</EM>
) is modeled and 5 pore volumes of filling solution are moved through the column (<EM CLASS="Emphasis">
shifts</EM>
/<EM CLASS="Emphasis">
cells</EM>
 is 5). The total time of the simulation is 25 yr (year) (<IMG SRC="phreeqc3-193.png" ALIGN="MIDDLE">
). The total length of the column is 6 m (four 1-m cells and one 2-m cell). </P>
<P CLASS="BodyText">
<A NAME="50622465_pgfId-663312"></A>At each shift, advection is simulated by moving solution <EM CLASS="Emphasis">
cells - </EM>
1 to cell <EM CLASS="Emphasis">
cells</EM>
, solution <EM CLASS="Emphasis">
cells - </EM>
2 to cell <EM CLASS="Emphasis">
cells - </EM>
1, and so on, until solution 0 is moved to cell 1 (upwind scheme). With flux-type boundary conditions, the dispersion steps follow the advective shift. With Dirichlet boundary conditions, the dispersion step and the advective shift are alternated. After each advective shift and dispersion step, kinetic reactions and chemical equilibria are calculated. The moles of pure phases and the compositions of the exchange assemblage, surface assemblage, gas phase, solid-solution assemblage, and kinetic reactants in each cell are updated after each chemical calculation.</P>
<P CLASS="BodyText">
<A NAME="50622465_pgfId-549032"></A>For advective transport, the influent solution must be defined, otherwise the program stops with an error message. Solution 0 is the influent with <STRONG CLASS="Bold">
-flow_direction forward</STRONG>
; solution cells + 1 is the influent when the flow is <STRONG CLASS="Bold">
backward</STRONG>
. If the effluent (solution cells + 1, for direction <STRONG CLASS="Bold">
forward</STRONG>
) is not defined, the program copies it from the effluent boundary cell in the column. A closed boundary condition is not possible with advective flow, and the boundary condition will be changed to a flux boundary condition. Likewise, a flux-boundary condition is not possible when pure diffusion is modeled, and the boundary condition will be changed to a closed boundary condition.</P>
<P CLASS="BodyText">
<A NAME="50622465_pgfId-545884"></A>The <STRONG CLASS="Bold">
-time_step</STRONG>
 identifier defines the length of time associated with each advective shift or diffusion period. The program may subdivide this time step into smaller dispersion time steps if necessary to calculate dispersion accurately. Each dispersion time step may be further subdivided to integrate the kinetic reactions (<A HREF="phreeqc3-24.htm#50622465_55637" CLASS="XRef">KINETICS</A> data block). Kinetic reactions are likely to slow the calculations by a factor of six or more compared to pure equilibrium calculations.</P>
<P CLASS="BodyText">
<A NAME="50622465_pgfId-545888"></A>The numerical scheme is for cell-centered concentrations, which has consequences for data interpretation. Thus, the composition in a boundary cell is a half-cell distance away from the column outlet and needs a half time step to arrive at (or from) the column end. The half time step must be added to the total residence time in the column when effluent from a column is simulated [use (TOTAL_TIME + <EM CLASS="Emphasis">
time step </EM>
/ 2) for time, see <A HREF="phreeqc3-70.htm#50622479_40270" CLASS="XRef">See 1D Transport: Kinetic Biodegradation, Cell Growth, and Sorption</A>, or ((STEP_NO + 0.5) / <EM CLASS="Emphasis">
cells</EM>
) for pore volumes, see <A HREF="phreeqc3-66.htm#50622479_46434" CLASS="XRef">See Transport and Cation Exchange</A>]. The kinetics time for advective transport into the boundary cell is the advective time step divided by 2. Also, the cell-centered scheme does not account for dispersion in the border half-cell in case of a flux boundary condition. The identifier <STRONG CLASS="Bold">
-correct_disp</STRONG>
 provides an option to correct the ignored dispersion by increasing the dispersivity for all cells in the column by the appropriate amount. The correction will improve the comparison with analytical solutions for conservative elements when the number of cells is small.</P>
<P CLASS="BodyText">
<A NAME="50622465_pgfId-549093"></A>A &#8220;dual porosity&#8221; model, in which part of the porosity allows advective flow and part of the porosity is accessible only by diffusion, can be developed with a first-order exchange model or with finite differences, and both approaches can be defined in terms of a mixing among cells (see &#8220;Transport in Dual Porosity Media&#8221; in Parkhurst and Appelo, 1999). With the <STRONG CLASS="Bold">
TRANSPORT</STRONG>
 data block, one column of mobile cells is used to represent the part of the flow system in which advection occurs, and then additional immobile cells connected to the mobile cells are used to represent the stagnant zone that is accessible only by diffusion. The stagnant zone can be defined to be parallel or perpendicular to the column of mobile cells or to be a combination of the two by proper definition of mixing factors in <A HREF="phreeqc3-27.htm#50622465_23725" CLASS="XRef">MIX</A> data blocks. A shortcut is available for the classical formulation of a dual porosity medium with a first-order rate of exchange. In this case, <STRONG CLASS="Bold">
-stagnant</STRONG>
 is used to define one stagnant cell for each mobile cell (<EM CLASS="Emphasis">
stagnant_cells</EM>
 = 1), an exchange factor (<EM CLASS="Emphasis">
exchange_factor</EM>
) for the exchange between immobile and mobile cells, and the porosities <IMG SRC="phreeqc3-194.png" ALIGN="MIDDLE">
 and <IMG SRC="phreeqc3-195.png" ALIGN="MIDDLE">
 for the mobile and immobile cells.</P>
<P CLASS="BodyText">
<A NAME="50622465_pgfId-545908"></A>Thermal diffusion can be modeled for a stagnant zone with first-order exchange between mobile and immobile cells. Thermal exchange is calculated after subtracting the part of the exchange that is associated with hydrodynamic diffusion (see &#8220;Transport of Heat&#8221; in Parkhurst and Appelo, 1999). PHREEQC uses the value of the <EM CLASS="Emphasis">
diffusion coefficient</EM>
 to find the correct heat exchange factor, and the value entered with identifier <STRONG CLASS="Bold">
-diffusion_coefficient</STRONG>
 should be the same as has been used to calculate the exchange factor <IMG SRC="phreeqc3-196.png" ALIGN="MIDDLE">
 (see equation 125 in Parkhurst and Appelo, 1999).</P>
<P CLASS="BodyText">
<A NAME="50622465_pgfId-765551"></A>Most of the information for advective-dispersive transport calculations must be entered with other keyword data blocks. Advective-dispersive transport assumes that solutions with numbers 1 through <EM CLASS="Emphasis">
cells</EM>
 have been defined by using <A HREF="phreeqc3-41.htm#50622465_89789" CLASS="XRef">SOLUTION</A>, <A HREF="phreeqc3-44.htm#50622465_84297" CLASS="XRef">SOLUTION_SPREAD</A>, or <A HREF="phreeqc3-37.htm#50622465_81857" CLASS="XRef">SAVE</A> data blocks. In addition the infilling solution must be defined. If <STRONG CLASS="Bold">
-flow_direction</STRONG>
 is <STRONG CLASS="Bold">
forward</STRONG>
, solution 0 is the infilling solution; if <STRONG CLASS="Bold">
-flow_direction</STRONG>
 is <STRONG CLASS="Bold">
backward</STRONG>
, solution <EM CLASS="Emphasis">
cells </EM>
+<EM CLASS="Emphasis">
 1</EM>
 is the infilling solution, if <STRONG CLASS="Bold">
-flow_direction</STRONG>
 is <STRONG CLASS="Bold">
diffusion_only</STRONG>
, then infilling solutions at both column ends are optional. If stagnant zones are modeled, solution compositions for the stagnant-zone cells must be defined with <A HREF="phreeqc3-41.htm#50622465_89789" CLASS="XRef">SOLUTION</A>, <A HREF="phreeqc3-44.htm#50622465_84297" CLASS="XRef">SOLUTION_SPREAD</A>, or <A HREF="phreeqc3-37.htm#50622465_81857" CLASS="XRef">SAVE</A> data blocks.</P>
<P CLASS="BodyText">
<A NAME="50622465_pgfId-719815"></A>Pure-phase assemblages may be defined with <A HREF="phreeqc3-13.htm#50622465_61207" CLASS="XRef">EQUILIBRIUM_PHASES</A> or <A HREF="phreeqc3-37.htm#50622465_81857" CLASS="XRef">SAVE</A>, with the number of the assemblage corresponding to the cell number. Likewise, an exchange assemblage, a surface assemblage, a gas phase, or a solid-solution assemblage can be defined for each cell through <A HREF="phreeqc3-14.htm#50622465_49135" CLASS="XRef">EXCHANGE</A>, <A HREF="phreeqc3-45.htm#50622465_56392" CLASS="XRef">SURFACE</A>, <A HREF="phreeqc3-17.htm#50622465_83409" CLASS="XRef">GAS_PHASE</A>, <A HREF="phreeqc3-40.htm#50622465_77444" CLASS="XRef">SOLID_SOLUTIONS</A>, or <A HREF="phreeqc3-37.htm#50622465_81857" CLASS="XRef">SAVE</A> keywords, with the identifying number corresponding to the cell number. Kinetically controlled reactions can be defined for each cell through the <A HREF="phreeqc3-24.htm#50622465_55637" CLASS="XRef">KINETICS</A> data block. Note that ranges of numbers can be used to define multiple solutions, exchange assemblages, surface assemblages, gas phases, solid-solution assemblages, or kinetic reactions simultaneously and that <A HREF="phreeqc3-37.htm#50622465_81857" CLASS="XRef">SAVE</A> allows definition of a range of numbers. Constant-rate reactions can be defined for mobile or immobile cells through <A HREF="phreeqc3-33.htm#50622465_75635" CLASS="XRef">REACTION</A> data blocks, again with the identifying number of the <A HREF="phreeqc3-33.htm#50622465_75635" CLASS="XRef">REACTION</A> data block corresponding to the cell number. <A HREF="phreeqc3-35.htm#50622465_75016" CLASS="XRef">REACTION_TEMPERATURE</A> data blocks can be used to specify the initial temperatures of the cells in the transport simulation. Temperatures in the cells may change during the transport simulation depending on the temperature distribution and the temperature retardation factor defined by <STRONG CLASS="Bold">
-thermal_diffusion</STRONG>
. <A HREF="phreeqc3-34.htm#50622465_65966" CLASS="XRef">REACTION_PRESSURE</A> data blocks can be used to set the pressure in each cell.</P>
<P CLASS="BodyText">
<A NAME="50622465_pgfId-719846"></A>By default, the composition of the solution, pure-phase assemblage, exchange assemblage, surface assemblage, gas phase, solid-solution assemblage, and kinetic reactants are printed for each cell for each shift. Use of <STRONG CLASS="Bold">
-print_cells </STRONG>
and <STRONG CLASS="Bold">
-print_frequency</STRONG>
 will limit the amount of data written to the output file. If <STRONG CLASS="Bold">
-print_cells </STRONG>
has been defined then only the specified cells will be written; otherwise, all cells will be written. The identifier <STRONG CLASS="Bold">
-print_frequency </STRONG>
will restrict writing to the output file to those shifts that are evenly divisible by <EM CLASS="Emphasis">
print_modulus</EM>
. In the Example data block, results for cells 1, 2, 3, and 5 are written to the output file after each integer pore volume (5 shifts) has passed through the column. Data written to the output file can be further limited with the keyword <A HREF="phreeqc3-31.htm#50622465_92102" CLASS="XRef">PRINT</A> (see <STRONG CLASS="Bold">
-reset false</STRONG>
). </P>
<P CLASS="BodyText">
<A NAME="50622465_pgfId-704751"></A>If a <A HREF="phreeqc3-38.htm#50622465_20239" CLASS="XRef">SELECTED_OUTPUT</A> data block has been defined, then selected data are written to the selected-output file. Use of <STRONG CLASS="Bold">
-punch_cells </STRONG>
and <STRONG CLASS="Bold">
-punch_frequency</STRONG>
 in the <STRONG CLASS="Bold">
TRANSPORT</STRONG>
 data block will limit the data that are written to the selected-output file. If <STRONG CLASS="Bold">
-punch_cells</STRONG>
 has been defined then only the specified cells will be written; otherwise, all cells will be written. The identifier <STRONG CLASS="Bold">
-punch_frequency </STRONG>
will restrict writing to the selected-output file to those shifts that are evenly divisible by <EM CLASS="Emphasis">
punch_modulus</EM>
. In the Example data block, results are written to the selected-output file for cells 2, 3, 4, and 5 after each integer pore volume (5 shifts) has passed through the column.</P>
<P CLASS="BodyText">
<A NAME="50622465_pgfId-719921"></A>At the end of an advective-dispersive transport simulation, all the physical and chemical data (for example, compositions of solutions, equilibrium-phase assemblages, surfaces, exchangers, solid solutions, and kinetic reactants) are automatically saved and are identified by the cell number in which they reside. These data are available for subsequent simulations within a single run. Transient conditions can be simulated by including subsequent <A HREF="phreeqc3-41.htm#50622465_89789" CLASS="XRef">SOLUTION</A> and <STRONG CLASS="Bold">
TRANSPORT</STRONG>
 data blocks, which may define new chemical boundary and transport conditions. Only parameters that differ from the previous advective-dispersive transport simulation need to be redefined, such as new infilling solution (<A HREF="phreeqc3-41.htm#50622465_89789" CLASS="XRef">SOLUTION</A> 0), a change from advection to diffusion only (<STRONG CLASS="Bold">
-flow_direction diffusion_only</STRONG>
), or a change in flow direction from forward to backward (<STRONG CLASS="Bold">
-flow_direction backward</STRONG>
). All parameters not specified in the new <STRONG CLASS="Bold">
TRANSPORT</STRONG>
 data block remain the same as the previous advective-dispersive transport simulation. Normally, the diffusion coefficient, lengths of cells, dispersivities, and stagnant zone definitions remain the same through all advective-dispersive transport simulations and thus need not be redefined.</P>
<P CLASS="BodyText">
<A NAME="50622465_pgfId-704817"></A>For long advective-dispersive transport calculations, it may be desirable to save intermediate states in the calculation, either because of hardware failure or because of nonconvergence of the numerical method. The <STRONG CLASS="Bold">
-dump_frequency</STRONG>
 identifier allows intermediate states to be saved at intervals during the calculation. The <STRONG CLASS="Bold">
-dump </STRONG>
identifier allows the definition of a file name in which to write these intermediate states. The dump file is formatted as an input file for PHREEQC, so calculations can be resumed from the point at which the dump file was made. The <STRONG CLASS="Bold">
-dump_restart</STRONG>
 identifier allows a shift number to be specified from which to restart the calculations. </P>
<P CLASS="BodyText">
<A NAME="50622465_pgfId-577010"></A>With the identifiers <STRONG CLASS="Bold">
-multi_D</STRONG>
 and <STRONG CLASS="Bold">
-interlayer_D</STRONG>
, diffusion can be calculated as a multicomponent process in uncharged (&#8220;free&#8221;) pore water, in electrostatic double layer (EDL, referred to as the Donnan pore space) water at charged surfaces, and in interlayer water of swelling clay minerals. Each solute species or surface defined with <STRONG CLASS="Bold">
-dw</STRONG>
<EM CLASS="Emphasis">
 </EM>
greater than zero diffuses at its own speed, while overall, charge balance is maintained (Vinograd and McBain, 1941; Appelo and Wersin, 2007).<EM CLASS="Emphasis">
 </EM>
Instead of concentration, as in Fick&#8217;s laws, the thermodynamic potential forms the basis for calculating the multicomponent flux:</P>
</DIV>
<DIV>
<H3 CLASS="EquationNumbered">
<A NAME="50622465_pgfId-577762"></A>&#956;i = &#956;i0 + RT ln ai + ziF&#968;,                 	(9)</H3>
<P CLASS="BodyTextFlush">
<A NAME="50622465_pgfId-577763"></A>where &#956;i0 is the standard thermodynamic potential of species i (J/mol, joule per mole), R is the gas constant (8.314 J K-1mol-1), T is the absolute temperature (K), ai is the activity (unitless), zi is charge number (unitless), F is the Faraday constant (96485 J V-1eq-1), and &#968; is the electrical potential (V). The activity is related to concentration ci (here, mol/m3) by ai = &#947;i ci/c0, where &#947;i is the activity coefficient (unitless) and c0 is the standard state (here 1.0 mol/m3). The diffusive flux of i as a result of chemical and electrical potential gradients is</P>
</DIV>
<DIV>
<H3 CLASS="EquationNumbered">
<A NAME="50622465_pgfId-575371"></A><A NAME="50622465_57764"></A><IMG SRC="phreeqc3-197.png" ALIGN="MIDDLE">
,             	(10)</H3>
<P CLASS="BodyTextFlush">
<A NAME="50622465_pgfId-575372"></A>where Ji is the flux of species i (mol m-2s-1), ui is the mobility (m2 s-1V-1, square meter per second per volt), ci is the concentration (mol/m3), zi is charge number (unitless), <IMG SRC="phreeqc3-198.png" ALIGN="MIDDLE">
 is the gradient of the chemical potential (J mol-1m-1, joule per mole per meter), and similarly for the gradients of lnai and &#968;. If the electrical current is zero, <IMG SRC="phreeqc3-199.png" ALIGN="MIDDLE">
, <A HREF="phreeqc3-49.htm#50622465_57764" CLASS="XRef">equation 10</A> can be rearranged to solve for the gradient of the electrical potential:</P>
</DIV>
<DIV>
<H3 CLASS="EquationNumbered">
<A NAME="50622465_pgfId-575390"></A><IMG SRC="phreeqc3-200.png" ALIGN="MIDDLE">
,                	(11)</H3>
<P CLASS="BodyTextFlush">
<A NAME="50622465_pgfId-575334"></A>where the variables are linked with species j to indicate their origin from the zero-charge transfer condition. With ai = &#947;i ci/c0 and cid(lnci) = d(ci), the gradient of the activity becomes:</P>
</DIV>
<DIV>
<H3 CLASS="EquationNumbered">
<A NAME="50622465_pgfId-575535"></A><IMG SRC="phreeqc3-201.png" ALIGN="MIDDLE">
.                 	(12)</H3>
<P CLASS="BodyTextFlush">
<A NAME="50622465_pgfId-575515"></A>And, finally, using the identity</P>
</DIV>
<DIV>
<H3 CLASS="EquationNumbered">
<A NAME="50622465_pgfId-587273"></A><IMG SRC="phreeqc3-202.png" ALIGN="MIDDLE">
,                	(13)</H3>
<P CLASS="BodyTextFlush">
<A NAME="50622465_pgfId-575405"></A><A HREF="phreeqc3-49.htm#50622465_57764" CLASS="XRef">equation 10</A> can be recast completely in known model variables:</P>
</DIV>
<DIV>
<H3 CLASS="EquationNumbered">
<A NAME="50622465_pgfId-575645"></A><A NAME="50622465_66275"></A><IMG SRC="phreeqc3-203.png" ALIGN="MIDDLE">
.               	(14)</H3>
<P CLASS="BodyText">
<A NAME="50622465_pgfId-575832"></A>Appelo and Wersin (2007) have shown that the thermodynamic potential gradients are the same in free pore water and in EDL water (the Donnan pore space); only the concentrations are different in the two water types. The concentration in the Donnan pore space is:</P>
</DIV>
<DIV>
<H3 CLASS="EquationNumbered">
<A NAME="50622465_pgfId-636734"></A><IMG SRC="phreeqc3-204.png" ALIGN="MIDDLE">
, 	(15)</H3>
<P CLASS="BodyTextFlush">
<A NAME="50622465_pgfId-576668"></A>where erm_DDLi is the enrichment factor in the Donnan pore space, defined with identifier <STRONG CLASS="Bold">
-erm_ddl</STRONG>
 in keyword <A HREF="phreeqc3-43.htm#50622465_96148" CLASS="XRef">SOLUTION_SPECIES</A>, and &#968;D is the potential in the Donnan pore space. Accordingly, for calculating the flux through the Donnan space, if <STRONG CLASS="Bold">
-only_counter_ions</STRONG>
 is <STRONG CLASS="Bold">
false</STRONG>
, ci in <A HREF="phreeqc3-49.htm#50622465_66275" CLASS="XRef">equation 14</A> is replaced by cDonnan, i for the fraction of Donnan water in the pore space. If <STRONG CLASS="Bold">
-only_counter_ions</STRONG>
 is <STRONG CLASS="Bold">
true</STRONG>
, the concentration gradient in free pore water is used for counter-ions (ci in <A HREF="phreeqc3-49.htm#50622465_66275" CLASS="XRef">equation 14</A> is not replaced for counter-ions), and for co-ions the flux is zero (their concentration is zero), see below.</P>
<P CLASS="BodyText">
<A NAME="50622465_pgfId-636710"></A>Diffusion of exchangeable cations can be calculated when they are defined with exchange species X<Sup CLASS="Superscript">
-</Sup>
, as in the databases phreeqc.dat and wateq4f.dat. The concentration of an exchangeable species is</P>
</DIV>
<DIV>
<H3 CLASS="EquationNumbered">
<A NAME="50622465_pgfId-636711"></A>ci = &#947;&#953;<EM CLASS="Emphasis">
 &#215; </EM>
&#946;&#953;<EM CLASS="Emphasis">
 &#215;</EM>
 CEC / zi, 	(16)</H3>
<P CLASS="BodyTextFlush">
<A NAME="50622465_pgfId-636712"></A>where ci is the concentration of species i (mol/m3 interlayer water), &#947;&#953; is the activity coefficient, defined with <STRONG CLASS="Bold">
-gamma </STRONG>
in keyword <A HREF="phreeqc3-16.htm#50622465_65476" CLASS="XRef">EXCHANGE_SPECIES</A>, &#946; is the equivalent fraction of the exchangeable species, and CEC is the exchange capacity (eq/m3, equivalent per cubic meter of interlayer water), defined as moles X- in keyword <A HREF="phreeqc3-14.htm#50622465_84573" CLASS="XRef">EXCHANGE</A> (the volume of interlayer water is calculated from the interlayer porosity, as explained below). For calculating the flux through the interlayer space, <IMG SRC="phreeqc3-205.png" ALIGN="MIDDLE">
 in <A HREF="phreeqc3-49.htm#50622465_66275" CLASS="XRef">equation 14</A> is replaced by <IMG SRC="phreeqc3-206.png" ALIGN="MIDDLE">
.</P>
<P CLASS="BodyText">
<A NAME="50622465_pgfId-636696"></A>The actual mass transfer is found by multiplying the flux by the surface area, which PHREEQC calculates either from the amount of water in a cell and the cell length in a regular column, or from the mixing factor defined for stagnant cells, assuming a density of water of 1 kg/L. Thus, in a regular column, the surface area for diffusion between two cells i and j is</P>
</DIV>
<DIV>
<H3 CLASS="EquationNumbered">
<A NAME="50622465_pgfId-636700"></A><IMG SRC="phreeqc3-207.png" ALIGN="MIDDLE">
, 	(17)</H3>
<P CLASS="BodyTextFlush">
<A NAME="50622465_pgfId-636704"></A>where Aij is the surface area (m2), wfree is kgw defined with <STRONG CLASS="Bold">
-water</STRONG>
 in keyword <A HREF="phreeqc3-41.htm#50622465_30253" CLASS="XRef">SOLUTION</A>, VDonnan is the volume of water in the Donnan pore space, equal to Asurf<EM CLASS="Emphasis">
 &#215;</EM>
 tDonnan, the product of the area of the surface (m2) and the thickness of the Donnan layer (m), both defined in keyword <A HREF="phreeqc3-45.htm#50622465_56392" CLASS="XRef">SURFACE</A>, and &#916;x is the cell length (m) defined with <STRONG CLASS="Bold">
-lengths</STRONG>
.</P>
<P CLASS="BodyText">
<A NAME="50622465_pgfId-636681"></A>For stagnant cells, the mixing factor is multiplied by the ratio of the diffusion coefficient of a species and the default diffusion coefficient that is used when calculating the mixing factor. The mixing factor is given by equation 128 of the PHREEQC version 2 manual (Parkhurst and Appelo, 1999) or equation S2 of Appelo and Wersin, 2007):</P>
</DIV>
<DIV>
<H3 CLASS="EquationNumbered">
<A NAME="50622465_pgfId-636686"></A><A NAME="50622465_73453"></A><IMG SRC="phreeqc3-208.png" ALIGN="MIDDLE">
,	(18)</H3>
<P CLASS="BodyTextFlush">
<A NAME="50622465_pgfId-765693"></A>where mixf<Sub CLASS="Subscript">
ij</Sub>
 is the mixing factor between cells i and j, defined with keyword <A HREF="phreeqc3-27.htm#50622465_23725" CLASS="XRef">MIX</A>. D<Sub CLASS="Subscript">
p</Sub>
 is the pore water diffusion coefficient, given by D<Sub CLASS="Subscript">
p</Sub>
 = D<Sub CLASS="Subscript">
w</Sub>
 &#949;<Sup CLASS="Superscript">
n</Sup>
, where D<Sub CLASS="Subscript">
w</Sub>
 is the default diffusion coefficient; &#949; is the porosity; and n is Archie&#8217;s factor, all defined with identifier <STRONG CLASS="Bold">
-multi_D</STRONG>
. &#916;t is the time step defined with <STRONG CLASS="Bold">
-time_step</STRONG>
. f<Sub CLASS="Subscript">
bc</Sub>
 is a correction factor that equals 2 for constant concentration boundary cells and is 1 otherwise, hij is the distance between the midpoints of cells i and j, and Vj is the volume of pore water in cell j for which the mass transfer is calculated. The mixfij that is defined in the input file must be calculated with a volume Vj of 0.001 m3. PHREEQC will adapt the value of mixfij by using the actual amount of water in the cell, which is given by (w<Sub CLASS="Subscript">
free</Sub>
/1000 + VDonnan). Furthermore, (according to <A HREF="phreeqc3-49.htm#50622465_73453" CLASS="XRef">equation 18</A>) the mixing factor for individual species is multiplied by D<Sub CLASS="Subscript">
w, i</Sub>
/D<Sub CLASS="Subscript">
w</Sub>
.</P>
<P CLASS="BodyText">
<A NAME="50622465_pgfId-636658"></A>For interlayer diffusion, PHREEQC calculates the surface area by</P>
</DIV>
<DIV>
<H3 CLASS="EquationNumbered">
<A NAME="50622465_pgfId-636662"></A><IMG SRC="phreeqc3-209.png" ALIGN="MIDDLE">
,	(19)</H3>
<P CLASS="BodyTextFlush">
<A NAME="50622465_pgfId-669053"></A>where &#949;IL is the porosity occupied by interlayer water, defined with identifier <STRONG CLASS="Bold">
-interlayer_D</STRONG>
, and &#949; is the porosity of free and Donnan pore water together, defined with<STRONG CLASS="Bold">
 -multi_D</STRONG>
. For stagnant cells, the mixing factor is multiplied with the ratio of the interlayer porosity and the free and Donnan porosity, and with the ratio of the diffusion coefficients, and of the inverse tortuosity coefficients. If the surface areas and (or) the porosities are different for the two cells, the harmonic mean is used (see <A HREF="phreeqc3-76.htm#50622479_68313" CLASS="XRef">See Modeling Diffusion of HTO, 36Cl-, 22Na+, and Cs+ in a Radial Diffusion Cell</A>, in <A HREF="phreeqc3-55.htm#50622479_31416" CLASS="XRef">Examples</A>). </P>
<P CLASS="BodyText">
<A NAME="50622465_pgfId-669060"></A>For the Donnan pore space, the enhanced concentration gradient for counter-ions and the decreased concentration gradient for co-ions is applied if identifier <STRONG CLASS="Bold">
-only_counter_ions </STRONG>
is <STRONG CLASS="Bold">
false</STRONG>
 in keyword <A HREF="phreeqc3-45.htm#50622465_56392" CLASS="XRef">SURFACE</A>. If identifier <STRONG CLASS="Bold">
-only_counter_ions</STRONG>
 is <STRONG CLASS="Bold">
true</STRONG>
, the concentration of the co-ions is zero in the Donnan space, and also the flux of the co-ions is zero. In this case, the concentration gradient of counter-ions in free pore water is used for the Donnan pore space for two reasons. First, because with only counter ions in the Donnan pore space, the concentrations of the counter-ions will be smaller than in free pore water if the surface charge is smaller than the charge of the co-ions in solution. This could give unrealistic gradients when surface charges are different from cell to cell. The second reason is that it allows direct comparison of multicomponent results of PHREEQC with traditional calculations in which Fick&#8217;s laws are used to model the behavior of individual tracers in clays and clay-containing rocks.</P>
<DIV>
<H6 CLASS="FM4thOrderHeading">
<A NAME="50622465_pgfId-545987"></A><A NAME="50622465_27197"></A>Example problems</H6>
<P CLASS="BodyText">
<A NAME="50622465_pgfId-757501"></A>The keyword <STRONG CLASS="Bold">
TRANSPORT </STRONG>
is used in example problems <A HREF="phreeqc3-66.htm#50622479_46434" CLASS="XRef">11</A>, <A HREF="phreeqc3-67.htm#50622479_12946" CLASS="XRef">12</A>, <A HREF="phreeqc3-68.htm#50622479_22265" CLASS="XRef">13</A>, <A HREF="phreeqc3-70.htm#50622479_40270" CLASS="XRef">15</A>, and <A HREF="phreeqc3-76.htm#50622479_68313" CLASS="XRef">21</A>. Examples of multicomponent diffusion are given in Appelo and Wersin (2007), supplementary information, Appelo and others (2008) and (2010), and in http://www.hydrochemistry.eu/exmpls/index.html#new (accessed June 25, 2012). An example of interlayer diffusion is available in http://www.hydrochemistry.eu/exmpls/opa_col.html#new2 (accessed June 25, 2012).</P>
</DIV>
<DIV>
<H6 CLASS="FM4thOrderHeading">
<A NAME="50622465_pgfId-757503"></A><A NAME="50622465_31306"></A>Related keywords</H6>
<P CLASS="BodyText">
<A NAME="50622465_pgfId-546020"></A><A HREF="phreeqc3-6.htm#50622465_87438" CLASS="XRef">ADVECTION</A>, <A HREF="phreeqc3-13.htm#50622465_61207" CLASS="XRef">EQUILIBRIUM_PHASES</A>, <A HREF="phreeqc3-14.htm#50622465_49135" CLASS="XRef">EXCHANGE</A>, <A HREF="phreeqc3-17.htm#50622465_83409" CLASS="XRef">GAS_PHASE</A>, <A HREF="phreeqc3-24.htm#50622465_55637" CLASS="XRef">KINETICS</A>, <A HREF="phreeqc3-27.htm#50622465_23725" CLASS="XRef">MIX</A>, <A HREF="phreeqc3-31.htm#50622465_92102" CLASS="XRef">PRINT</A>, <A HREF="phreeqc3-33.htm#50622465_75635" CLASS="XRef">REACTION</A>, <A HREF="phreeqc3-35.htm#50622465_75016" CLASS="XRef">REACTION_TEMPERATURE</A>, <A HREF="phreeqc3-37.htm#50622465_81857" CLASS="XRef">SAVE</A>, <A HREF="phreeqc3-38.htm#50622465_20239" CLASS="XRef">SELECTED_OUTPUT</A>, <A HREF="phreeqc3-40.htm#50622465_77444" CLASS="XRef">SOLID_SOLUTIONS</A>, <A HREF="phreeqc3-41.htm#50622465_89789" CLASS="XRef">SOLUTION</A>, and <A HREF="phreeqc3-45.htm#50622465_56392" CLASS="XRef">SURFACE</A>.</P>
</DIV>
</DIV>
<HR><P> | <A HREF="phreeqc3-50.htm">Next</A> || <A HREF="phreeqc3-48.htm">Previous</A> || <A HREF="phreeqc3.htm">Top</A>  | </P></BODY>
</HTML>
